(window.webpackJsonp=window.webpackJsonp||[]).push([[87],{"/Ixg":function(e,t,n){"use strict";var a,s,i=n("zjfJ"),r=n("ERkP"),o=n.n(r),c=n("RNvQ"),p=n.n(c),l=(n("aWzz"),n("L21V")),u=n("2sr0"),d=n("Pf68"),h=n("JOcB"),f=n("pkwY"),y=n("KD1n"),O=n("KsTJ"),g=n("MwrP"),b=n.n(g),m=n("nnRT"),S=n.n(m),v=n("dDc+"),j=n("TgHt"),w=n("7M9M"),x=n("mWiq"),P=n.n(x),E=n("IJlJ");function C(){const e=Object(y.a)(["\n  display: flex;\n"]);return C=function(){return e},e}function k(){const e=Object(y.a)(["\n  background-image: url(",");\n  width: 18px;\n  height: 18px;\n"]);return k=function(){return e},e}function T(){const e=Object(y.a)(["\n  display: flex;\n  flex: 0 1 auto;\n  margin-right: 9px;\n  margin-left: 6px;\n  opacity: ",";\n"]);return T=function(){return e},e}function L(){const e=Object(y.a)(["\n  align-items: center;\n  justify-content: center;\n  display: flex;\n  flex-direction: row;\n  line-height: 1.2;\n  padding: 2px;\n"]);return L=function(){return e},e}function D(){const e=Object(y.a)(["\n  color: ",";\n  min-width: 0;\n  font-size: 12px;\n  line-height: 1;\n  font-weight: 600;\n  margin-bottom: 10px;\n"]);return D=function(){return e},e}function q(){const e=Object(y.a)(["\n  display: inline-block;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  flex: 1 0 auto;\n  opacity: ",";\n"]);return q=function(){return e},e}const M=()=>{},V=O.default.div(q(),e=>e.isGreyedOut?.5:1),I=O.default.div(D(),v.colors.N200),R=O.default.div(L()),K=O.default.div(T(),e=>e.isGreyedOut?.5:1),A=O.default.img(k(),e=>w.CONTEXT_PATH+e.src),N=O.default.div(C()),_={container:e=>Object(f.a)({},e,{width:"100%"}),dropdownIndicator:e=>Object(f.a)({},e,{paddingLeft:0}),menu:e=>Object(f.a)({},e,{width:"100%"}),input:e=>Object(f.a)({},e,{width:"100%",marginLeft:0,paddingLeft:"7px"}),option:(e,{isFocused:t})=>{const n=t?v.colors.N900:null;let a;return t&&(a=v.colors.N30),Object(f.a)({},e,{backgroundColor:a,color:n})},placeholder:e=>Object(f.a)({},e,{paddingLeft:"5px"}),valueContainer:e=>Object(f.a)({},e,{width:"100%",padding:"2px 8px 2px 0px"}),singleValue:e=>Object(f.a)({},e,{width:"100%",padding:"2px 8px 2px 0px"})},z={name:"",key:"default-key",iconPath:"/images/logo/default-space-logo-256.png"};function Q({showSpaceLabel:e}){return!1===e?null:o.a.createElement(I,null,o.a.createElement(l.c,{id:"space-selector.create.drawer.header",defaultMessage:"Space",description:"The header of Space Selector"}))}Q.displayName="LabelComponent";const H=Object(l.h)((s=a=class extends r.PureComponent{static getDerivedStateFromProps(e,t){return(e.spaceKey===t.spaceKey||e.isLoading)&&!S()(t.currentSpace,z)||b()(e.defaultSpace)?Object(f.a)({},t,{isDisabled:e.spaceKey!==t.spaceKey&&e.isLoading}):Object(f.a)({},t,{currentSpace:e.defaultSpace,spaceKey:e.spaceKey,isDisabled:!1})}constructor(...e){super(...e),Object(i.a)(this,"onSelect",e=>{const{isRestricted:t}=e,n=e.key||"";this.setState({currentSpace:e}),this.props.fireAnalyticsEvent({type:"sendUIEvent",data:{source:"createPageDrawer",actionSubjectId:"spaceSelectorDropdownMenu",actionSubject:"spaceSelectorDropdownMenuItem",action:"clicked",attributes:{spaceKey:n}}}),this.props.onSelect({spaceKey:n,spaceName:e.name||"",isRestricted:t})}),Object(i.a)(this,"filterOption",this.props.filterOption?e=>{var t,n;return this.props.filterOption({spaceKey:(null!=(n=e)&&null!=(n=n.data)?n.key:n)||"",spaceName:(null!=(t=e)&&null!=(t=t.data)?t.name:t)||"",isRestricted:e.isRestricted})}:void 0),Object(i.a)(this,"getOption",({children:e,iconPath:t,name:n,isGreyedOut:a})=>o.a.createElement(R,null,this.renderSpaceIcon({iconPath:t,name:n,isGreyedOut:a}),e)),Object(i.a)(this,"getOptionLabel",e=>e.name),Object(i.a)(this,"getOptionValue",e=>e.key),Object(i.a)(this,"getLockIcon",()=>o.a.createElement(E.a,{content:this.props.intl.formatMessage({id:"space-selector.no.permission.to.create",defaultMessage:"You don't have create permissions in this space",description:"The tooltip message appearing next to lock icon in the space selector indicating that the space is restricted"})},o.a.createElement(P.a,{primaryColor:v.colors.N300,label:this.props.intl.formatMessage({id:"space-selector.restricted-space.icon",description:"aria-label for the restricted content icon appearing in the space selector",defaultMessage:"This space is restricted"})}))),Object(i.a)(this,"getLabel",({name:e,iconPath:t,isRestricted:n},a)=>{const s=this.getOption,i=n&&"value"!==a;return o.a.createElement(s,{iconPath:t,name:e,isGreyedOut:i},o.a.createElement(V,{isGreyedOut:i,control:!0},e),o.a.createElement(N,null,n?this.getLockIcon():null))}),Object(i.a)(this,"formatOptionLabel",(e,{context:t})=>this.getLabel(e,t)),Object(i.a)(this,"noOptionsMessage",()=>o.a.createElement(l.c,{id:"space-selector.create.drawer.no.space.found",defaultMessage:"No space found",description:"The text inside the space selector drop down of create page drawer telling user that no space is found with the user query input"})),Object(i.a)(this,"loadingMessage",()=>o.a.createElement(l.c,{id:"space-selector.create.drawer.spaces.loading",defaultMessage:"Loading spaces",description:"The text inside the space selector drop down of create page drawer telling user it is searching for spaces"}));const[t]=e;this.state={currentSpace:b()(t.defaultSpace)?t.showDefaultSpace?z:null:t.defaultSpace,spaceKey:t.spaceKey}}renderSpaceIcon({iconPath:e,name:t,isGreyedOut:n}){const a=e&&0===e.indexOf(w.CONTEXT_PATH)?e:"".concat(w.CONTEXT_PATH).concat(e);return o.a.createElement(K,{isGreyedOut:n},o.a.createElement(A,{src:a,label:t}))}render(){const{id:e,onChangeFilter:t,loadOptions:n,defaultOptions:a,placeholder:s,showSpaceLabel:i,validationState:c}=this.props,{currentSpace:p,isDisabled:l}=this.state;return o.a.createElement(r.Fragment,null,o.a.createElement(Q,{showSpaceLabel:i}),o.a.createElement(j.a,{"data-test-id":"space-select",placeholder:s,id:e,onChange:this.onSelect,value:p,isDisabled:l,isClearable:!1,noOptionsMessage:this.noOptionsMessage,loadingMessage:this.loadingMessage,loadOptions:n,defaultOptions:a,formatOptionLabel:this.formatOptionLabel,getOptionLabel:this.getOptionLabel,getOptionValue:this.getOptionValue,onInputChange:t,isMulti:!1,styles:_,validationState:c,filterOption:this.filterOption,classNamePrefix:"react-select"}))}},Object(i.a)(a,"defaultProps",{inputValue:"",fetchSpaces:M,onChangeFilter:M,onSelect:M,fireAnalyticsEvent:M,defaultOptions:[],loadOptions:Promise.resolve([]),defaultSpace:{},placeholder:o.a.createElement(l.c,{id:"space-selector.create.drawer.select.a.space",defaultMessage:"Select a space",description:"The placeholder of Space Selector"}),showDefaultSpace:!0,showSpaceLabel:!0}),s));var F=n("H5qd"),G=n.n(F);function J(){const e=Object(y.a)(["\n  query SpaceSelectorQuery($cql: String!, $limit: Int) {\n    favoriteSpaces: spaces(offset: 0, first: $limit, favourite: true) {\n      nodes {\n        id\n        key\n        name\n        operations {\n          operation\n          targetType\n        }\n        history {\n          createdBy {\n            displayName\n          }\n        }\n        icon {\n          path\n        }\n      }\n    }\n    searchedSpaces: search(cql: $cql, first: $limit) {\n      count\n      nodes {\n        space {\n          id\n          homepage {\n            id\n          }\n          operations {\n            operation\n            targetType\n          }\n          key\n          icon {\n            path\n          }\n          name\n        }\n      }\n    }\n    user {\n      id\n      confluence {\n        hasPersonalSpace\n        space {\n          id\n          name\n          key\n          operations {\n            operation\n            targetType\n          }\n        }\n      }\n    }\n    recentlyVisitedSpaces: recentSpaces {\n      key\n      id\n      name\n      icon {\n        path\n      }\n      operations {\n        operation\n        targetType\n      }\n    }\n  }\n"]);return J=function(){return e},e}const W=G()(J());function U(){const e=Object(y.a)(["\n  query SpaceSelectorPromotedSpacesQuery @experimental {\n    experimentalPromotedSpaces {\n      nodes {\n        id\n        text\n      }\n    }\n  }\n"]);return U=function(){return e},e}const $=G()(U());function Y(){const e=Object(y.a)(["\n  query SpaceSelectorDefaultSpaceQuery($spaceKey: String!) {\n    defaultSpaces: spaces(spaceKey: $spaceKey, first: 1) {\n      nodes {\n        id\n        key\n        name\n        operations {\n          operation\n          targetType\n        }\n        homepage {\n          id\n          title\n        }\n        icon {\n          path\n          width\n          height\n          isDefault\n        }\n        type\n        operations {\n          operation\n          targetType\n        }\n      }\n    }\n  }\n"]);return Y=function(){return e},e}const B=G()(Y());function X(){const e=Object(y.a)(["\n  query SpaceSelectorRecentlyVisitedSpacesQuery {\n    recentlyVisitedSpaces: recentSpaces {\n      key\n      id\n      name\n      icon {\n        path\n      }\n      operations {\n        operation\n        targetType\n      }\n    }\n  }\n"]);return X=function(){return e},e}const Z=G()(X());var ee,te;n.d(t,"a",(function(){return ae}));const ne=()=>{},ae=Object(l.h)(Object(u.a)()((te=ee=class extends r.Component{constructor(e){super(e),Object(i.a)(this,"fireAnalyticsEvent",e=>{"function"==typeof this.props.createAnalyticsEvent&&this.props.createAnalyticsEvent(e).fire()}),Object(i.a)(this,"_handleFilterChange",e=>{this.fireAnalyticsEvent({type:"sendUIEvent",data:{source:"createPageDrawer",actionSubjectId:"spaceSelectorDropdown",actionSubject:"spaceSelectorDropdownSearch",action:"search",attributes:{query:e}}}),this.setState({spaceQuery:e})}),Object(i.a)(this,"handleFilterChange",p()(this._handleFilterChange,500)),Object(i.a)(this,"onSelect",({spaceKey:e,spaceName:t,isRestricted:n})=>{const{onChange:a}=this.props;a({spaceKey:e,spaceName:t,isRestricted:n})}),Object(i.a)(this,"processData",e=>(e||[]).map(e=>{var t;return(null!=(t=e)?t.space:t)||e}).filter(e=>!!e).reduce((e,t)=>{const{name:n,key:a,icon:s,iconPath:i,id:r,text:o,operations:c}=t,p=s&&s.path||i||"";let l=!1;return c&&(l=!c.some(e=>!!this.props.operationsUsedToDetermineRestrictedStatus.find(t=>t.targetType===e.targetType&&t.operation===e.operation))),l&&!this.props.showRestrictedSpaces||e.push({name:n||o,key:a||r,iconPath:p,isRestricted:l}),e},[])),Object(i.a)(this,"getItems",(e,{favoriteSpaces:t,searchedSpaces:n,recentSpaces:a})=>[{label:this.props.intl.formatMessage({id:"create.drawer.space.selector.my.spaces",defaultMessage:"My Spaces",description:"The text header inside the space selector drop down that show the list of user favorite spaces"}),options:e?[]:t,dataTestID:"my-spaces"},{label:this.props.intl.formatMessage({id:"create.drawer.space.selector.recent.spaces",defaultMessage:"Recent Spaces",description:"The text header inside the space selector drop down that show the list of user recent visited spaces"}),options:e?[]:a,dataTestID:"recent-spaces"},{label:this.props.intl.formatMessage({id:"create.drawer.space.selector.search.spaces",defaultMessage:"All Spaces",description:"The text header inside the space selector drop down that show the spaces result after user enter query"}),options:e?n:[],dataTestID:"search-spaces"}]),Object(i.a)(this,"loadOptions",(e,t)=>(this._handleFilterChange(t),e({cql:this.getSpacesSearchCql(t),limit:25}).then(e=>{var n,a,s,i;const{data:r}=e,o=null!=(i=r)&&null!=(i=i.favoriteSpaces)?i.nodes:i,c=null!=(s=r)&&null!=(s=s.searchedSpaces)?s.nodes:s,p=null!=(a=r)?a.recentlyVisitedSpaces:a,l=(null!=(n=r)&&null!=(n=n.experimentalPromotedSpaces)?n.nodes:n)||[],u=!0===this.props.isAnonymous?l:p;return this.getItems(t,{favoriteSpaces:this.processData(o),searchedSpaces:this.processData(c),recentSpaces:this.processData(u)})}))),this.state={spaceQuery:null,spaceKey:e.spaceKey}}getSpacesSearchCql(e){let t="type = 'space'";return e&&(t+=" AND title ~ '".concat(e.replace(/\'/g,"%27"),"*'")),t}render(){const{spaceQuery:e}=this.state,{spaceKey:t}=this.props,n=[{query:W,errorPolicy:"all",fetchPolicy:"cache-first",variables:{cql:this.getSpacesSearchCql(e),limit:25},context:{single:!0}},{query:$,errorPolicy:"all",fetchPolicy:"cache-first",context:{single:!0}},{query:Z,fetchPolicy:"cache-first",context:{single:!0}}];return t&&n.push({query:B,fetchPolicy:"cache-first",variables:{spaceKey:t},context:{single:!0}}),o.a.createElement(h.a,{queryProps:n},({results:n,loading:a,properties:s})=>{var i,r,c,p,l,u;const[h,f,y,O]=n,[g]=s,b=(null!=(u=g)?u.refetch:u)||ne,m=(null!=(l=h)&&null!=(l=l.data)&&null!=(l=l.favoriteSpaces)?l.nodes:l)||[],S=(null!=(p=h)&&null!=(p=p.data)&&null!=(p=p.searchedSpaces)?p.nodes:p)||[],v=this.processData((null!=(c=y)&&null!=(c=c.data)?c.recentlyVisitedSpaces:c)||[]),j=this.processData((null!=(r=O)&&null!=(r=r.data)&&null!=(r=r.defaultSpaces)?r.nodes:r)||[]),w=this.processData((null!=(i=f)&&null!=(i=i.data)&&null!=(i=i.experimentalPromotedSpaces)?i.nodes:i)||[]),x=!0===this.props.isAnonymous?w:v,P=j[0]||{},E=this.getItems(e,{favoriteSpaces:this.processData(m).filter(e=>e.key!==P.key),searchedSpaces:this.processData(S),recentSpaces:x.filter(e=>e.key!==P.key)});return o.a.createElement(H,{onSelect:this.onSelect,fireAnalyticsEvent:this.fireAnalyticsEvent,id:this.props.id,isLoading:a,searchKeyword:e,onChangeFilter:this.handleFilterChange,defaultSpace:P,defaultOptions:E,loadOptions:Object(d.a)((...e)=>this.loadOptions(b,...e),500),placeholder:this.props.placeholder,spaceKey:t,showDefaultSpace:this.props.showDefaultSpace,showSpaceLabel:this.props.showSpaceLabel,validationState:this.props.validationState,filterOption:this.props.filterOption})})}},Object(i.a)(ee,"defaultProps",{onChange:ne,createAnalyticsEvent:()=>({fire:ne}),showDefaultSpace:!0,showRestrictedSpaces:!0,showSpaceLabel:!0,validationState:"default",operationsUsedToDetermineRestrictedStatus:[{targetType:"space",operation:"update"},{targetType:"page",operation:"create"}]}),Object(i.a)(ee,"displayName","SpaceSelector"),te)))},FaXr:function(e,t,n){"use strict";n.d(t,"b",(function(){return b}));var a=n("HbGN"),s=n("cxan"),i=(n("fGyu"),n("pkwY"),n("9fIP")),r=n("MMYH"),o=n("K/z8"),c=n("sRHE"),p=n("8K1b"),l=n("pWxA"),u=n("zjfJ"),d=n("ERkP"),h=n.n(d),f=(n("l1C2"),n("7nmT"),n("aWzz"),n("4wDe"),n("pQGW")),y=n("Un7B"),O=(n("5IAQ"),n("KD1n"),n("jynR"),n("hEw0")),g={cacheOptions:!1,defaultOptions:!1,filterOption:null},b=function(e){var t,n;return n=t=function(t){function n(e){var t;return Object(i.a)(this,n),t=Object(o.a)(this,Object(c.a)(n).call(this)),Object(u.a)(Object(l.a)(Object(l.a)(t)),"select",void 0),Object(u.a)(Object(l.a)(Object(l.a)(t)),"lastRequest",void 0),Object(u.a)(Object(l.a)(Object(l.a)(t)),"mounted",!1),Object(u.a)(Object(l.a)(Object(l.a)(t)),"optionsCache",{}),Object(u.a)(Object(l.a)(Object(l.a)(t)),"handleInputChange",(function(e,n){var a=t.props,s=a.cacheOptions,i=a.onInputChange,r=Object(f.k)(e,n,i);if(!r)return delete t.lastRequest,void t.setState({inputValue:"",loadedInputValue:"",loadedOptions:[],isLoading:!1,passEmptyOptions:!1});if(s&&t.optionsCache[r])t.setState({inputValue:r,loadedInputValue:r,loadedOptions:t.optionsCache[r],isLoading:!1,passEmptyOptions:!1});else{var o=t.lastRequest={};t.setState({inputValue:r,isLoading:!0,passEmptyOptions:!t.state.loadedInputValue},(function(){t.loadOptions(r,(function(e){t.mounted&&(e&&(t.optionsCache[r]=e),o===t.lastRequest&&(delete t.lastRequest,t.setState({isLoading:!1,loadedInputValue:r,loadedOptions:e||[],passEmptyOptions:!1})))}))}))}return r})),t.state={defaultOptions:Array.isArray(e.defaultOptions)?e.defaultOptions:void 0,inputValue:void 0!==e.inputValue?e.inputValue:"",isLoading:!0===e.defaultOptions,loadedOptions:[],passEmptyOptions:!1},t}return Object(p.a)(n,t),Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.mounted=!0;var t=this.props.defaultOptions,n=this.state.inputValue;!0===t&&this.loadOptions(n,(function(t){if(e.mounted){var n=!!e.lastRequest;e.setState({defaultOptions:t||[],isLoading:n})}}))}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.cacheOptions!==this.props.cacheOptions&&(this.optionsCache={}),e.defaultOptions!==this.props.defaultOptions&&this.setState({defaultOptions:Array.isArray(e.defaultOptions)?e.defaultOptions:void 0})}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"focus",value:function(){this.select.focus()}},{key:"blur",value:function(){this.select.blur()}},{key:"loadOptions",value:function(e,t){var n=this.props.loadOptions;if(!n)return t();var a=n(e,t);a&&"function"==typeof a.then&&a.then(t,(function(){return t()}))}},{key:"render",value:function(){var t=this,n=this.props,i=(n.loadOptions,Object(a.a)(n,["loadOptions"])),r=this.state,o=r.defaultOptions,c=r.inputValue,p=r.isLoading,l=r.loadedInputValue,u=r.loadedOptions,d=r.passEmptyOptions?[]:c&&l?u:o||[];return h.a.createElement(e,Object(s.a)({},i,{ref:function(e){t.select=e},options:d,isLoading:p,onInputChange:this.handleInputChange}))}}]),n}(d.Component),Object(u.a)(t,"defaultProps",g),n},m=Object(O.a)(y.a),S=b(m);t.a=S},JOcB:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n("cxan"),s=n("HbGN"),i=n("zjfJ"),r=n("ERkP"),o=n.n(r),c=n("gQ5V");n("aWzz");class p extends r.Component{constructor(...e){super(...e),Object(i.a)(this,"_queryResults",[]),Object(i.a)(this,"_queryProperties",[]),Object(i.a)(this,"_anyLoading",()=>this._queryResults.some(e=>!0===e.loading)),Object(i.a)(this,"_renderQueryComponent",(e,t,n)=>e.length?o.a.createElement(c.b,Object(a.a)({errorPolicy:"all"},e[n]),a=>{let{data:i,loading:r,error:o}=a,c=Object(s.a)(a,["data","loading","error"]);this._queryResults[n]={data:i,loading:r,error:o},this._queryProperties[n]=c;const p=n+1;return e.length>p?this._renderQueryComponent(e,t,p):t({results:this._queryResults,loading:this._anyLoading(),properties:this._queryProperties})}):t({results:[],loading:!1}))}render(){const{queryProps:e,children:t}=this.props;return this._renderQueryComponent(e,t,0)}}p.displayName="QueryGroup"},MwrP:function(e,t,n){var a=n("4uJK"),s=n("kkM+"),i=n("bvyN"),r=n("wxYD"),o=n("9y2L"),c=n("3ajY"),p=n("CbIe"),l=n("Qd2C"),u=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(o(e)&&(r(e)||"string"==typeof e||"function"==typeof e.splice||c(e)||l(e)||i(e)))return!e.length;var t=s(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(p(e))return!a(e).length;for(var n in e)if(u.call(e,n))return!1;return!0}},Pf68:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=(e,t=0)=>{let n=null,a=[];return(...s)=>(clearTimeout(n),n=setTimeout(()=>{const t=e(...s);a.forEach(e=>e(t)),a=[]},t),new Promise(e=>a.push(e)))}},TgHt:function(e,t,n){"use strict";var a=n("FaXr"),s=n("Lz2b");t.a=Object(s.a)(a.a)},mWiq:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(n("ERkP")),s=i(n("4KTy"));function i(e){return e&&e.__esModule?e:{default:e}}function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var o=function(e){return a.default.createElement(s.default,r({dangerouslySetGlyph:'<svg width="24" height="24" viewBox="0 0 24 24" focusable="false" role="presentation"><g fill="currentColor"><path d="M16 11V9h-2V7.002A2.001 2.001 0 0 0 12 5c-1.102 0-2 .898-2 2.002V9H8v2H7v8h10v-8h-1zm-2 0h-4V9h4v2zM8 9V7.002A4.004 4.004 0 0 1 12 3a4 4 0 0 1 4 4.002V9h.994A2.01 2.01 0 0 1 19 11.009v7.982c0 1.11-.897 2.009-2.006 2.009H7.006A2.009 2.009 0 0 1 5 18.991V11.01C5 9.899 5.897 9 7.006 9H8zm0 0h2v2H8V9zm6 0h2v2h-2V9z"/><circle cx="12" cy="15" r="2"/></g></svg>'},e))};o.displayName="LockIcon";var c=o;t.default=c}}]);
//# sourceMappingURL=87.A2ceXCAm-v39.js.map