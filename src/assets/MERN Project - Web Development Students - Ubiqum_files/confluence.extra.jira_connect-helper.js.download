WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'confluence.extra.jira:connect-helper', location = 'util/connect-helper.js' */
define("confluence/jim/util/connect-helper",["jquery","window","document"],function(e,d,a){function b(g,f){if(!f){f=d.location.href}g=g.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+g+"(=([^&#]*)|&|#|$)"),h=i.exec(f);if(!h){return null}if(!h[2]){return""}return decodeURIComponent(h[2].replace(/\+/g," "))}var c={getClientIds:function(g,i){var h=g.split(",");var f=[];h.forEach(function(j){var m=j.split("_");m[3]=i;var n=m.join("_");var l=a.querySelectorAll('[data-client-id="'+j+'"]');for(var k=0;k<l.length;k++){l[k].setAttribute("data-client-id",n);l[k].setAttribute("data-jira-key","issue-table-"+n)}f.push(n)});return f.join(",")},isConnect:function(){var g=d.frameElement&&d.frameElement.getAttribute("name");var f=d.frameElement&&d.frameElement.getAttribute("data-is-fallback-mode-iframe")==="true";return typeof d.AP!=="undefined"&&g!=="fallback-mode-iframe"&&!f},request:function(h,g){var i=new e.Deferred();if(typeof h==="object"){g=h;h=g.url}g=g||{};var k=g.success||function(){};var f=g.error||function(){};var j=i.promise();g.success=function(n,m,p){if(g.contentType&&g.contentType==="application/json"){try{n=JSON.parse(n)}catch(o){n={};console.error("Unable to convert response to JSON.")}}var l=[n,m,p];j.status=p.status;j.statusText=p.statusText;j.responseText=p.responseText;k.apply(this,l);i.resolveWith(i,l)};g.error=function(m,n,l){j.status=m.status;j.statusText=m.statusText;j.responseText=m.responseText;f.apply(this,arguments);i.rejectWith(i,arguments)};d.AP.request(h,g);return j},getAccountId:function(){var f=e.Deferred();if(c.isConnect()){d.AP.user.getCurrentUser(function(g){f.resolve(g.atlassianAccountId)})}else{e.ajax("/gateway/api/me").done(function(g){f.resolve(g.account_id)}).fail(function(){f.resolve("anonymous")})}return f.promise()}};return c});
}catch(e){WRMCB(e)};