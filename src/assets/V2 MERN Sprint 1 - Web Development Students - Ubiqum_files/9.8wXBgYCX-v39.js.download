/*! For license information please see 9.8wXBgYCX-v39.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"+gXh":function(e,t,n){(function(i){var r;!function(s){var l=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};function o(){this._events={},this._conf&&a.call(this,this._conf)}function a(e){e?(this._conf=e,e.delimiter&&(this.delimiter=e.delimiter),this._maxListeners=void 0!==e.maxListeners?e.maxListeners:10,e.wildcard&&(this.wildcard=e.wildcard),e.newListener&&(this.newListener=e.newListener),e.verboseMemoryLeak&&(this.verboseMemoryLeak=e.verboseMemoryLeak),this.wildcard&&(this.listenerTree={})):this._maxListeners=10}function c(e,t){var n="(node) warning: possible EventEmitter memory leak detected. "+e+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(n+=" Event name: "+t+"."),void 0!==i&&i.emitWarning){var r=new Error(n);r.name="MaxListenersExceededWarning",r.emitter=this,r.count=e,i.emitWarning(r)}else console.error(n),console.trace&&console.trace()}function h(e){this._events={},this.newListener=!1,this.verboseMemoryLeak=!1,a.call(this,e)}function u(e,t,n,i){if(!n)return[];var r,s,l,o,a,c,h,f=[],d=t.length,p=t[i],y=t[i+1];if(i===d&&n._listeners){if("function"==typeof n._listeners)return e&&e.push(n._listeners),[n];for(r=0,s=n._listeners.length;r<s;r++)e&&e.push(n._listeners[r]);return[n]}if("*"===p||"**"===p||n[p]){if("*"===p){for(l in n)"_listeners"!==l&&n.hasOwnProperty(l)&&(f=f.concat(u(e,t,n[l],i+1)));return f}if("**"===p){for(l in(h=i+1===d||i+2===d&&"*"===y)&&n._listeners&&(f=f.concat(u(e,t,n,d))),n)"_listeners"!==l&&n.hasOwnProperty(l)&&("*"===l||"**"===l?(n[l]._listeners&&!h&&(f=f.concat(u(e,t,n[l],d))),f=f.concat(u(e,t,n[l],i))):f=l===y?f.concat(u(e,t,n[l],i+2)):f.concat(u(e,t,n[l],i)));return f}f=f.concat(u(e,t,n[p],i+1))}if((o=n["*"])&&u(e,t,o,i+1),a=n["**"])if(i<d)for(l in a._listeners&&u(e,t,a,d),a)"_listeners"!==l&&a.hasOwnProperty(l)&&(l===y?u(e,t,a[l],i+2):l===p?u(e,t,a[l],i+1):((c={})[l]=a[l],u(e,t,{"**":c},i+1)));else a._listeners?u(e,t,a,d):a["*"]&&a["*"]._listeners&&u(e,t,a["*"],d);return f}function f(e,t){for(var n=0,i=(e="string"==typeof e?e.split(this.delimiter):e.slice()).length;n+1<i;n++)if("**"===e[n]&&"**"===e[n+1])return;for(var r=this.listenerTree,s=e.shift();void 0!==s;){if(r[s]||(r[s]={}),r=r[s],0===e.length)return r._listeners?("function"==typeof r._listeners&&(r._listeners=[r._listeners]),r._listeners.push(t),!r._listeners.warned&&this._maxListeners>0&&r._listeners.length>this._maxListeners&&(r._listeners.warned=!0,c.call(this,r._listeners.length,s))):r._listeners=t,!0;s=e.shift()}return!0}h.EventEmitter2=h,h.prototype.delimiter=".",h.prototype.setMaxListeners=function(e){void 0!==e&&(this._maxListeners=e,this._conf||(this._conf={}),this._conf.maxListeners=e)},h.prototype.event="",h.prototype.once=function(e,t){return this._once(e,t,!1)},h.prototype.prependOnceListener=function(e,t){return this._once(e,t,!0)},h.prototype._once=function(e,t,n){return this._many(e,1,t,n),this},h.prototype.many=function(e,t,n){return this._many(e,t,n,!1)},h.prototype.prependMany=function(e,t,n){return this._many(e,t,n,!0)},h.prototype._many=function(e,t,n,i){var r=this;if("function"!=typeof n)throw new Error("many only accepts instances of Function");function s(){return 0==--t&&r.off(e,s),n.apply(this,arguments)}return s._origin=n,this._on(e,s,i),r},h.prototype.emit=function(){this._events||o.call(this);var e=arguments[0];if("newListener"===e&&!this.newListener&&!this._events.newListener)return!1;var t,n,i,r,s,l=arguments.length;if(this._all&&this._all.length){if(s=this._all.slice(),l>3)for(t=new Array(l),r=0;r<l;r++)t[r]=arguments[r];for(i=0,n=s.length;i<n;i++)switch(this.event=e,l){case 1:s[i].call(this,e);break;case 2:s[i].call(this,e,arguments[1]);break;case 3:s[i].call(this,e,arguments[1],arguments[2]);break;default:s[i].apply(this,t)}}if(this.wildcard){s=[];var a="string"==typeof e?e.split(this.delimiter):e.slice();u.call(this,s,a,this.listenerTree,0)}else{if("function"==typeof(s=this._events[e])){switch(this.event=e,l){case 1:s.call(this);break;case 2:s.call(this,arguments[1]);break;case 3:s.call(this,arguments[1],arguments[2]);break;default:for(t=new Array(l-1),r=1;r<l;r++)t[r-1]=arguments[r];s.apply(this,t)}return!0}s&&(s=s.slice())}if(s&&s.length){if(l>3)for(t=new Array(l-1),r=1;r<l;r++)t[r-1]=arguments[r];for(i=0,n=s.length;i<n;i++)switch(this.event=e,l){case 1:s[i].call(this);break;case 2:s[i].call(this,arguments[1]);break;case 3:s[i].call(this,arguments[1],arguments[2]);break;default:s[i].apply(this,t)}return!0}if(!this._all&&"error"===e)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},h.prototype.emitAsync=function(){this._events||o.call(this);var e=arguments[0];if("newListener"===e&&!this.newListener&&!this._events.newListener)return Promise.resolve([!1]);var t,n,i,r,s,l=[],a=arguments.length;if(this._all){if(a>3)for(t=new Array(a),r=1;r<a;r++)t[r]=arguments[r];for(i=0,n=this._all.length;i<n;i++)switch(this.event=e,a){case 1:l.push(this._all[i].call(this,e));break;case 2:l.push(this._all[i].call(this,e,arguments[1]));break;case 3:l.push(this._all[i].call(this,e,arguments[1],arguments[2]));break;default:l.push(this._all[i].apply(this,t))}}if(this.wildcard){s=[];var c="string"==typeof e?e.split(this.delimiter):e.slice();u.call(this,s,c,this.listenerTree,0)}else s=this._events[e];if("function"==typeof s)switch(this.event=e,a){case 1:l.push(s.call(this));break;case 2:l.push(s.call(this,arguments[1]));break;case 3:l.push(s.call(this,arguments[1],arguments[2]));break;default:for(t=new Array(a-1),r=1;r<a;r++)t[r-1]=arguments[r];l.push(s.apply(this,t))}else if(s&&s.length){if(s=s.slice(),a>3)for(t=new Array(a-1),r=1;r<a;r++)t[r-1]=arguments[r];for(i=0,n=s.length;i<n;i++)switch(this.event=e,a){case 1:l.push(s[i].call(this));break;case 2:l.push(s[i].call(this,arguments[1]));break;case 3:l.push(s[i].call(this,arguments[1],arguments[2]));break;default:l.push(s[i].apply(this,t))}}else if(!this._all&&"error"===e)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(l)},h.prototype.on=function(e,t){return this._on(e,t,!1)},h.prototype.prependListener=function(e,t){return this._on(e,t,!0)},h.prototype.onAny=function(e){return this._onAny(e,!1)},h.prototype.prependAny=function(e){return this._onAny(e,!0)},h.prototype.addListener=h.prototype.on,h.prototype._onAny=function(e,t){if("function"!=typeof e)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),t?this._all.unshift(e):this._all.push(e),this},h.prototype._on=function(e,t,n){if("function"==typeof e)return this._onAny(e,t),this;if("function"!=typeof t)throw new Error("on only accepts instances of Function");return this._events||o.call(this),this.emit("newListener",e,t),this.wildcard?(f.call(this,e,t),this):(this._events[e]?("function"==typeof this._events[e]&&(this._events[e]=[this._events[e]]),n?this._events[e].unshift(t):this._events[e].push(t),!this._events[e].warned&&this._maxListeners>0&&this._events[e].length>this._maxListeners&&(this._events[e].warned=!0,c.call(this,this._events[e].length,e))):this._events[e]=t,this)},h.prototype.off=function(e,t){if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");var n,i=[];if(this.wildcard){var r="string"==typeof e?e.split(this.delimiter):e.slice();i=u.call(this,null,r,this.listenerTree,0)}else{if(!this._events[e])return this;n=this._events[e],i.push({_listeners:n})}for(var s=0;s<i.length;s++){var o=i[s];if(n=o._listeners,l(n)){for(var a=-1,c=0,h=n.length;c<h;c++)if(n[c]===t||n[c].listener&&n[c].listener===t||n[c]._origin&&n[c]._origin===t){a=c;break}if(a<0)continue;return this.wildcard?o._listeners.splice(a,1):this._events[e].splice(a,1),0===n.length&&(this.wildcard?delete o._listeners:delete this._events[e]),this.emit("removeListener",e,t),this}(n===t||n.listener&&n.listener===t||n._origin&&n._origin===t)&&(this.wildcard?delete o._listeners:delete this._events[e],this.emit("removeListener",e,t))}return function e(t){if(void 0!==t){var n=Object.keys(t);for(var i in n){var r=n[i],s=t[r];s instanceof Function||"object"!=typeof s||null===s||(Object.keys(s).length>0&&e(t[r]),0===Object.keys(s).length&&delete t[r])}}}(this.listenerTree),this},h.prototype.offAny=function(e){var t,n=0,i=0;if(e&&this._all&&this._all.length>0){for(n=0,i=(t=this._all).length;n<i;n++)if(e===t[n])return t.splice(n,1),this.emit("removeListenerAny",e),this}else{for(n=0,i=(t=this._all).length;n<i;n++)this.emit("removeListenerAny",t[n]);this._all=[]}return this},h.prototype.removeListener=h.prototype.off,h.prototype.removeAllListeners=function(e){if(0===arguments.length)return!this._events||o.call(this),this;if(this.wildcard)for(var t="string"==typeof e?e.split(this.delimiter):e.slice(),n=u.call(this,null,t,this.listenerTree,0),i=0;i<n.length;i++){var r=n[i];r._listeners=null}else this._events&&(this._events[e]=null);return this},h.prototype.listeners=function(e){if(this.wildcard){var t=[],n="string"==typeof e?e.split(this.delimiter):e.slice();return u.call(this,t,n,this.listenerTree,0),t}return this._events||o.call(this),this._events[e]||(this._events[e]=[]),l(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]},h.prototype.eventNames=function(){return Object.keys(this._events)},h.prototype.listenerCount=function(e){return this.listeners(e).length},h.prototype.listenersAny=function(){return this._all?this._all:[]},void 0===(r=function(){return h}.call(t,n,t,e))||(e.exports=r)}()}).call(this,n("F63i"))},"1Y1u":function(e,t,n){"use strict";var i=n("nnRT"),r=n.n(i),s=n("ZoNr"),l=n("8TdO"),o=n("KD1n"),a=n("H5qd"),c=n.n(a);function h(){const e=Object(o.a)(["\n  mutation FileUploadMutation(\n    $size: Int!\n    $contentType: String!\n    $mimeType: String!\n    $fileName: String!\n    $pageId: String!\n    $fileStoreId: String!\n    $minorEdit: Boolean\n    $renderEditorHTML: Boolean\n    $collectionName: String!\n  ) @experimental {\n    experimentalFileUpload(\n      size: $size\n      contentType: $contentType\n      mimeType: $mimeType\n      fileName: $fileName\n      pageId: $pageId\n      fileStoreId: $fileStoreId\n      minorEdit: $minorEdit\n      renderEditorHTML: $renderEditorHTML\n      collectionName: $collectionName\n    )\n  }\n"]);return h=function(){return e},e}const u=c()(h());function f(){const e=Object(o.a)(["\n  query MediaConfigQuery @experimental {\n    experimentalMediaConfig {\n      clientId\n      fileStoreUrl\n    }\n  }\n"]);return f=function(){return e},e}const d=c()(f());function p(){const e=Object(o.a)(["\n  query MediaDownloadTokenQuery($contentId: ID!, $status: [String]) {\n    content(id: $contentId, status: $status) {\n      nodes {\n        id\n        body {\n          atlas_doc_format {\n            mediaToken {\n              token\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return p=function(){return e},e}const y=c()(p());function m(){const e=Object(o.a)(["\n  query MediaUploadTokenQuery($contentId: ID!) @experimental {\n    experimentalUploadToken(contentId: $contentId) {\n      token {\n        value\n      }\n      configuration {\n        clientId\n        fileStoreUrl\n      }\n      collection\n      mediaPickerUserToken {\n        id\n        token\n      }\n    }\n  }\n"]);return m=function(){return e},e}const _=c()(m()),v=async()=>await Object(l.getApolloClient)().query({query:d,variables:{},fetchPolicy:"network-only"}),g=async e=>await Object(l.getApolloClient)().query({query:y,variables:{contentId:e,status:["current","draft"]},fetchPolicy:"network-only"}),w=()=>{},k=e=>e.contentId&&e.contentType?t=>{const{id:n,name:i,size:r,mimeType:s}=t,{contentId:o,contentType:a}=e;(e=>{Object(l.getApolloClient)().mutate({mutation:u,variables:e})})({size:r,contentType:a,mimeType:s,fileName:i,pageId:o,fileStoreId:n,minorEdit:!0,renderEditorHTML:!1,collectionName:"contentId-".concat(o)})}:w;n.d(t,"a",(function(){return b})),n.d(t,"d",(function(){return S})),n.d(t,"c",(function(){return M})),n.d(t,"b",(function(){return $}));const b=(e,t)=>{let n=null,i=null,s=null;return{getValue:l=>{const o=Date.now();return(!n||n+t<=o||!r()(l,s))&&(s=l,n=o,i=e(l)),i},resetCache:()=>n=null}},L=b(async e=>{var t,n;const[i,r]=await Promise.all([g(e.contentId),T.getValue()]);return{token:(null!=(n=i)&&null!=(n=n.data)&&null!=(n=n.content)&&null!=(n=n.nodes)&&null!=(n=n[0])&&null!=(n=n.body)&&null!=(n=n.atlas_doc_format)&&null!=(n=n.mediaToken)?n.token:n)||"",config:null!=(t=r)&&null!=(t=t.data)?t.experimentalMediaConfig:t}},54e4),T=b(()=>v(),54e4),I=(e,t,n)=>t(e).then(({config:{clientId:e},token:t})=>({clientId:e,token:t,baseUrl:n})),A=async e=>{var t,n;const[i,r]=await Promise.all([g(e),v()]),{clientId:s,fileStoreUrl:l}=null!=(n=r)&&null!=(n=n.data)?n.experimentalMediaConfig:n;return{clientId:s,token:(null!=(t=i)&&null!=(t=t.data)&&null!=(t=t.content)&&null!=(t=t.nodes)&&null!=(t=t[0])&&null!=(t=t.body)&&null!=(t=t.atlas_doc_format)&&null!=(t=t.mediaToken)?t.token:t)||"",baseUrl:l}},E=b(async e=>{var t,n,i,r;const s=await(async e=>await Object(l.getApolloClient)().query({query:_,variables:{contentId:e},fetchPolicy:"network-only"}))(e.contentId);return{token:(null!=(r=s)&&null!=(r=r.data)&&null!=(r=r.experimentalUploadToken)&&null!=(r=r.token)?r.value:r)||"",config:(null!=(i=s)&&null!=(i=i.data)&&null!=(i=i.experimentalUploadToken)?i.configuration:i)||"",collectionId:(null!=(n=s)&&null!=(n=n.data)&&null!=(n=n.experimentalUploadToken)?n.collection:n)||"",mediaPickerUserToken:(null!=(t=s)&&null!=(t=t.data)&&null!=(t=t.experimentalUploadToken)?t.mediaPickerUserToken:t)||""}},54e4),x=async e=>(await E.getValue(e)).collectionId,S=e=>(e=>L.getValue(e).then(t=>t.token?t:(L.resetCache(),L.getValue(e))).then(t=>({authProvider:()=>I(e,L.getValue,t.config.fileStoreUrl),getAuthFromContext:A})))(e).then(e=>e),U=e=>(e=>E.getValue(e).then(t=>{const n=t.mediaPickerUserToken?t.mediaPickerUserToken:void 0;return{authProvider:()=>I(e,E.getValue,t.config.fileStoreUrl),userAuthProvider:n&&(()=>Promise.resolve({clientId:n.id,token:n.token,baseUrl:t.config.fileStoreUrl})),getAuthFromContext:A}}))(e).then(e=>e),M=async e=>({viewMediaClientConfig:await S(e)}),$=async e=>{C(e);const[t,n,i]=await Promise.all([S(e),U(e),x(e)]);return{viewMediaClientConfig:t,uploadParams:{collection:i},uploadMediaClientConfig:n}};let P;const C=e=>{P&&s.a.off("file-added",P),P=k(e),s.a.on("file-added",P)}},XOyS:function(e,t,n){"use strict";n.r(t);var i=n("+gXh"),r={streams:new(n("bShy").LRUCache)(1e3),stateDeferreds:new Map,eventEmitter:new i.EventEmitter2};function s(e){return!!e.clientId}function l(e){return!!e.asapIssuer}var o=function(e){return l(e)?e:{id:e.clientId,baseUrl:e.baseUrl,token:e.token}};n.d(t,"mediaState",(function(){return r})),n.d(t,"isClientBasedAuth",(function(){return s})),n.d(t,"isAsapBasedAuth",(function(){return l})),n.d(t,"authToOwner",(function(){return o}))},ZoNr:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("XOyS"),r={on:function(e,t){i.mediaState.eventEmitter&&i.mediaState.eventEmitter.on(e,t)},off:function(e,t){i.mediaState.eventEmitter&&i.mediaState.eventEmitter.off(e,t)},emit:function(e,t){if(i.mediaState.eventEmitter)return i.mediaState.eventEmitter.emit(e,t)}}}}]);
//# sourceMappingURL=9.8wXBgYCX-v39.js.map