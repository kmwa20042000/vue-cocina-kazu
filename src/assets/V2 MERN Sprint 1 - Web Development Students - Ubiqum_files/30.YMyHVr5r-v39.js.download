(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{"82Bo":function(e,t,n){"use strict";var r=n("cxan"),o=n("HbGN"),a=n("KD1n"),i=n("zjfJ"),s=n("ERkP"),c=n.n(s),u=n("L21V"),l=n("lZoD"),d=n("lSUb"),p=n("zdnd"),f=n("vdYO"),h=n("JpEQ"),m=n("ROar"),g=n("/FQd"),b=n("daKX"),y=n("bR0+"),v=n("7M9M"),O=n("Ua4J"),j=n("+mzV"),w=n("qhEF"),I=n("1Y1u"),P=n("rGGD"),_=n("8TdO"),E=n("H5qd");function T(){const e=Object(a.a)(["\n  mutation SetTaskStatusMutation(\n    $contentId: ID!\n    $taskId: ID!\n    $status: TaskStatus!\n  ) {\n    setTaskStatus(\n      inlineTasksInput: {\n        cid: $contentId\n        taskId: $taskId\n        status: $status\n        trigger: VIEW_PAGE\n      }\n    ) {\n      success\n    }\n  }\n"]);return T=function(){return e},e}const k=n.n(E)()(T()),x=Object(u.g)({flagTitle:{id:"fabric-media-support.tasklist.error.flag.title",description:"Flag title to inform user that an attempt to toggle a tasklist checkbox failed",defaultMessage:"Something went wrong"},flagDescription:{id:"fabric-media-support.tasklist.error.flag.description",description:"Flag description to inform user that an attempt to toggle a tasklist checkbox failed",defaultMessage:"An error occurred while trying to change a task's status. Please try again later."}});class D{constructor(e,t,n){this.intl=e,this.flags=t,this.contentId=n}toggleTask(e,t){return Object(_.getApolloClient)().mutate({mutation:k,variables:{contentId:this.contentId,taskId:e.localId,status:"DONE"===t?"CHECKED":"UNCHECKED"}}).then(e=>{var n;return(null!=(n=e)&&null!=(n=n.data)&&null!=(n=n.setTaskStatus)?n.success:n)||!1||this.showErrorFlag(),t}).catch(e=>{this.showErrorFlag()})}showErrorFlag(){this.flags.showErrorFlag({title:this.intl.formatMessage(x.flagTitle),description:this.intl.formatMessage(x.flagDescription)})}notifyRecentUpdates(e){}subscribe(e,t){}unsubscribe(e,t){}unsubscribeRecentUpdates(e){}}var R=n("YPyD");const S=new(n("gOKa").b)({url:"/gateway/api/directory/graphql",cacheSize:100,cacheMaxAge:3e5});var H=n("HN9L");function C(){const e=Object(a.a)(["\n  margin-bottom: ",";\n  padding-top: 5px;\n  overflow-y: ",";\n"]);return C=function(){return e},e}const M=n("KsTJ").default.div(C(),e=>"comment"===e.appearance?"0":"10px",e=>"comment"===e.appearance?"hidden":"auto");n.d(t,"a",(function(){return A}));Object(b.a)("Comment Renderer");const A=Object(u.h)(class extends s.PureComponent{constructor(...e){super(...e),Object(i.a)(this,"handleProfileCardActions",e=>t=>{const{intl:n}=this.props;return[{label:n.formatMessage({id:"view.profile"}),callback:()=>{e(Object(y.a)(t,null,v.CONTEXT_PATH))}}]}),Object(i.a)(this,"getDataProviders",Object(d.a)(({contentId:e,spaceKey:t,push:n,cloudId:r,userId:o,flags:a},i)=>{const{getDataProviders:s,intl:c}=this.props,u={};if(s&&Object.assign(u,s()),e&&(u.mediaProvider=Object(I.c)({contentId:e})),r&&o&&(u.mentionProvider=Object(P.a)(r,o).then(e=>e.mentionResource).catch(e=>Promise.reject())),e&&(u.taskDecisionProvider=Promise.resolve(new D(c,a,e))),r&&(u.emojiProvider=Object(R.a)(h.a,{cloudId:r,source:"view"}),u.profilecardProvider=function(e,t){return Promise.resolve({cloudId:e,resourceClient:S,getActions:t})}(r,this.handleProfileCardActions(n))),e&&t&&(u.contextIdentifierProvider=Promise.resolve({containerId:t,objectId:e,product:"confluence"})),u.cardProvider=Promise.resolve(new H.a),Object.keys(u).length){i=i||m.a.create({});for(const e of Object.keys(u))i.setProvider(e,u[e])}return i})),Object(i.a)(this,"getExtensionHandlers",Object(d.a)((e={})=>{const{getExtensionHandlers:t}=this.props;return t?Object.assign(t(),e):e})),Object(i.a)(this,"getEventHandlers",Object(d.a)(e=>{const{getEventHandlers:t}=this.props;return t?Object.assign(t(),e):e}))}componentDidMount(){this.handleRendered()}componentDidUpdate(){this.handleRendered()}handleRendered(){const{onRendered:e}=this.props;e&&e()}render(){const e=this.props,{document:t,dataProviders:n,extensionHandlers:a,eventHandlers:i,appearance:s="comment",allowDynamicTextSizing:u=!0,adfStage:d="stage0",getEventHandlers:h,getExtensionHandlers:m,portalRef:b}=e,y=Object(o.a)(e,["document","dataProviders","extensionHandlers","eventHandlers","appearance","allowDynamicTextSizing","adfStage","getEventHandlers","getExtensionHandlers","portalRef"]);return t?c.a.createElement(O.a.Consumer,null,({push:e})=>c.a.createElement(j.a.Consumer,null,({spaceKey:o,contentId:h})=>c.a.createElement(M,{appearance:s},c.a.createElement(g.a,null,({cloudId:m,userId:g})=>c.a.createElement(l.c,{to:[w.a]},l=>{const v=c.a.createElement(p.a,Object(r.a)({adfStage:d,document:t,appearance:s,allowDynamicTextSizing:u,extensionHandlers:this.getExtensionHandlers(a),eventHandlers:this.getEventHandlers(i),dataProviders:this.getDataProviders({spaceKey:o,contentId:this.props.contentId?this.props.contentId:h,push:e,cloudId:m,userId:g,flags:l},n),portal:b||void 0},y));return c.a.createElement(f.d,null,v)}))))):null}});A.displayName="ADFRenderer"},HN9L:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("KD1n"),o=n("vdYO"),a=n("8TdO"),i=n("daKX"),s=n("/FQd");function c(){const e=Object(r.a)(["Error while trying to obtain Feature Flag"]);return c=function(){return e},e}const u=Object(i.a)("CardProvider");let l=!1;(async()=>{try{const{featureFlags:e}=await Object(s.b)(Object(a.getApolloClient)());l=!!e["confluence.frontend.fabric.editor.smartcards"]}catch(e){u.error(c()),u.error(e)}})();class d extends o.c{async resolve(e){return l&&super.resolve(e,"inline")}}},WmVM:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Default=1]="Default",e[e.UsageFrequency=2]="UsageFrequency"}(r||(r={}))},YPyD:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));n("KD1n");var r=n("pFSi"),o=n.n(r),a=n("daKX");Object(a.a)("emoji-provider");const i="/gateway/api/emoji",s=o()((e,t)=>{const n=((e,t)=>{const n=t?{id:t}:void 0,r={providers:[{url:"".concat(i,"/standard")},{url:"".concat(i,"/atlassian")}],allowUpload:!0,currentUser:n};return e&&r.providers.push({url:"".concat(i,"/").concat(e,"/site")}),r})(t&&t.cloudId?t.cloudId:"",t?t.userId:void 0);let r;try{r=new e(n)}catch(e){0}return Promise.resolve(r)},(e,t)=>{const n=t&&t.cloudId?t.cloudId:"",r=t&&t.source?t.source:"";return"".concat(n,"_").concat(r)})},rGGD:function(e,t,n){"use strict";var r=n("/FQd"),o=n("8TdO"),a=n("jkYY"),i=n("NvSU"),s=n("7M9M");async function c(e,t,n){var c;if(!e)throw new Error("MentionResource cannot be configured without a cloud id");const u=(null!=(c=n)?c.spaceId:c)||void 0;return{mentionResource:await async function(e,t,n){const i={url:"".concat("/gateway/api/mentions","/").concat(e),productId:"micros-group/confluence",containerId:t||void 0,shouldHighlightMention:e=>e.id===n},c=await Object(r.b)(Object(o.getApolloClient)()),{featureFlags:u}=c,l=u["confluence.frontend.people.directory"]?s.CONTEXT_PATH:"",d={url:"/gateway/api/teams/mentions",productId:"micros-group/confluence",shouldHighlightMention:e=>e.id===n,teamHighlightEnabled:u["confluence.frontend.fabric.editor.team.mention.spotlight"],createTeamPath:"".concat(l,"/people/search#createTeam")};return new a.a(i,d)}(e,u,t),presenceResource:new i.a({url:"/gateway/api/directory/graphql",cloudId:e,productId:"confluence"})}}function u(e,t,n){return c(e,t,n)}n.d(t,"a",(function(){return u}))},rhKZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("D57K"),o=!1;function a(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];o&&console.log.apply(console,Object(r.__spread)([e],t))}},"x+QU":function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n("ERkP"),c=n("aWzz"),u=[],l=[];function d(e){var t=e(),n={loading:!0,loaded:null,error:null};return n.promise=t.then((function(e){return n.loading=!1,n.loaded=e,e})).catch((function(e){throw n.loading=!1,n.error=e,e})),n}function p(e){var t={loading:!1,loaded:{},error:null},n=[];try{Object.keys(e).forEach((function(r){var o=d(e[r]);o.loading?t.loading=!0:(t.loaded[r]=o.loaded,t.error=o.error),n.push(o.promise),o.promise.then((function(e){t.loaded[r]=e})).catch((function(e){t.error=e}))}))}catch(e){t.error=e}return t.promise=Promise.all(n).then((function(e){return t.loading=!1,e})).catch((function(e){throw t.loading=!1,e})),t}function f(e,t){return s.createElement((n=e)&&n.__esModule?n.default:n,t);var n}function h(e,t){var d,p;if(!t.loading)throw new Error("react-loadable requires a `loading` component");var h=Object.assign({loader:null,loading:null,delay:200,timeout:null,render:f,webpack:null,modules:null},t),m=null;function g(){return m||(m=e(h.loader)),m.promise}return u.push(g),"function"==typeof h.webpack&&l.push((function(){if(e=h.webpack,"object"===r(n.m)&&e().every((function(e){return void 0!==e&&void 0!==n.m[e]})))return g();var e})),p=d=function(t){function n(r){o(this,n);var i=a(this,t.call(this,r));return i.retry=function(){i.setState({error:null,loading:!0,timedOut:!1}),m=e(h.loader),i._loadModule()},g(),i.state={error:m.error,pastDelay:!1,timedOut:!1,loading:m.loading,loaded:m.loaded},i}return i(n,t),n.preload=function(){return g()},n.prototype.componentWillMount=function(){this._mounted=!0,this._loadModule()},n.prototype._loadModule=function(){var e=this;if(this.context.loadable&&Array.isArray(h.modules)&&h.modules.forEach((function(t){e.context.loadable.report(t)})),m.loading){"number"==typeof h.delay&&(0===h.delay?this.setState({pastDelay:!0}):this._delay=setTimeout((function(){e.setState({pastDelay:!0})}),h.delay)),"number"==typeof h.timeout&&(this._timeout=setTimeout((function(){e.setState({timedOut:!0})}),h.timeout));var t=function(){e._mounted&&(e.setState({error:m.error,loaded:m.loaded,loading:m.loading}),e._clearTimeouts())};m.promise.then((function(){t()})).catch((function(e){t()}))}},n.prototype.componentWillUnmount=function(){this._mounted=!1,this._clearTimeouts()},n.prototype._clearTimeouts=function(){clearTimeout(this._delay),clearTimeout(this._timeout)},n.prototype.render=function(){return this.state.loading||this.state.error?s.createElement(h.loading,{isLoading:this.state.loading,pastDelay:this.state.pastDelay,timedOut:this.state.timedOut,error:this.state.error,retry:this.retry}):this.state.loaded?h.render(this.state.loaded,this.props):null},n}(s.Component),d.contextTypes={loadable:c.shape({report:c.func.isRequired})},p}function m(e){return h(d,e)}m.Map=function(e){if("function"!=typeof e.render)throw new Error("LoadableMap requires a `render(loaded, props)` function");return h(p,e)};var g=function(e){function t(){return o(this,t),a(this,e.apply(this,arguments))}return i(t,e),t.prototype.getChildContext=function(){return{loadable:{report:this.props.report}}},t.prototype.render=function(){return s.Children.only(this.props.children)},t}(s.Component);function b(e){for(var t=[];e.length;){var n=e.pop();t.push(n())}return Promise.all(t).then((function(){if(e.length)return b(e)}))}g.propTypes={report:c.func.isRequired},g.childContextTypes={loadable:c.shape({report:c.func.isRequired}).isRequired},m.Capture=g,m.preloadAll=function(){return new Promise((function(e,t){b(u).then(e,t)}))},m.preloadReady=function(){return new Promise((function(e,t){b(l).then(e,e)}))},e.exports=m},xN70:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return f})),n.d(t,"d",(function(){return h}));var r=n("D57K"),o=n("F00T"),a=n("nYST"),i=n("rhKZ"),s=function(e,t){var n=e.getRatio,a=void 0===n?u:n,i=Object(r.__rest)(e,["getRatio"]),s=c(a),l=t||{},d=l.queryParams,p=void 0===d?{}:d,f=Object(r.__rest)(l,["queryParams"]),h=Object(r.__assign)(Object(r.__assign)({},f),{queryParams:Object(r.__assign)(Object(r.__assign)({},s),p)});return o.b.requestService(i,h)},c=function(e){return e()>1?{scale:"XHDPI",altScale:"XXXHDPI"}:{altScale:"XHDPI"}},u=function(){return window.devicePixelRatio},l=function(e){return e[c(u).altScale]},d=function(e,t){if(Object(a.p)(e)&&t&&t.spriteSheets){var n=e,r=n.height,o=n.width,s=n.x,c=n.y,u=n.xIndex,l=n.yIndex,d=n.spriteRef,p=t.spriteSheets[d];if(p)return{sprite:p,height:r,width:o,x:s,y:c,xIndex:u,yIndex:l}}else if(Object(a.i)(e)){r=e.height,o=e.width;var f=e.imagePath;return function(e,t){return!(!t||!t.mediaApiToken||0!==e.indexOf(t.mediaApiToken.url))}(f,t)?Object(a.c)(e):{height:r,width:o,imagePath:f}}Object(i.a)("failed conversion for representation",e,t)},p=function(e,t){return e&&e!=={}?d(l(e),t):void 0},f=function(e){return{emojis:e.emojis.map((function(t){var n=d(t.representation,e.meta),o=p(t.altRepresentations,e.meta),i=function(e,t){if(!e.skinVariations)return[];var n=e.skinVariations,o=e.id;return n.map((function(e){var n=e.representation,a=e.altRepresentations,i=Object(r.__rest)(e,["representation","altRepresentations"]);return Object(r.__assign)({baseId:o,representation:d(n,t),altRepresentation:p(a,t)},i)}))}(t,e.meta),s=(t.representation,t.skinVariations,t.altRepresentations,Object(r.__rest)(t,["representation","skinVariations","altRepresentations"])),c=Object(r.__assign)(Object(r.__assign)({},s),{representation:n,skinVariations:i});return Object(a.a)(c,o)})),mediaApiToken:e.meta&&e.meta.mediaApiToken}},h=function(e,t){return!!(t&&e.altRepresentation&&function(e){return u()>1?2*e:e}(t)>e.representation.height)}}}]);
//# sourceMappingURL=30.YMyHVr5r-v39.js.map