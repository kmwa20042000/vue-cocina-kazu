(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{"52M7":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("D57K"),r=n("EfWO"),a=n("4CAG"),i=n("itm6"),s={},c=function(e,t){if(t)for(var n in t)if({}.hasOwnProperty.call(t,n)){var o=t[n];if(Array.isArray(o))for(var r=0;r<o.length;r++)e.append(n,o[r]);else e.append(n,o)}};t.requestService=function(e,n){var l=e.url,d=e.securityProvider,u=e.refreshedSecurityProvider,p=n||s,h=p.path,f=p.queryParams,m=p.requestInit,b=d&&d(),v=function(e,t,n,o){void 0===t&&(t="");var i=new a(r.parse(e).search||void 0);if(e=e.split("?")[0],n)for(var s in n)({}).hasOwnProperty.call(n,s)&&i.append(s,n[s]);if(o&&o.params)for(var s in o.params)if({}.hasOwnProperty.call(o.params,s)){var c=o.params[s];if(Array.isArray(c))for(var l=0;l<c.length;l++)i.append(s,c[l]);else i.append(s,c)}var d="";t&&"/"!==e.substr(-1)&&(d="/");var u=i.toString();return u&&(u="?"+u),""+e+d+t+u}(l,h,f,b),g=function(e,t){var n=new Headers;return c(n,t),e&&c(n,e.headers),n}(b,m&&m.headers),C=i.buildCredentials(b),y=o.__assign({},m,{headers:g,credentials:C});return fetch(new Request(v,y)).then((function(e){return 204===e.status?Promise.resolve():e.ok?e.json():401===e.status&&u?u().then((function(e){var o={url:l,securityProvider:function(){return e}};return t.requestService(o,n)})):Promise.reject({code:e.status,reason:e.statusText})}))}},DAlY:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){this.listeners=new Set}return e.prototype.subscribe=function(e){this.listeners.add(e),this.lastResult&&e.result(this.lastResult)},e.prototype.unsubscribe=function(e){this.listeners.delete(e)},e.prototype.notifyResult=function(e){this.listeners.forEach((function(t){t.result(e)}))},e.prototype.notifyError=function(e){this.listeners.forEach((function(t){t.error&&t.error(e)}))},e.prototype.notifyInfo=function(e){this.listeners.forEach((function(t){t.info&&t.info(e)}))},e.prototype.notifyNotReady=function(){this.listeners.forEach((function(e){e.notReady&&e.notReady()}))},e}();t.AbstractResource=o},LUsr:function(e,t,n){"use strict";function o(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),o(n("itm6")),o(n("DAlY"));var r=n("52M7");t.utils=r},TVRZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var o=n("ERkP"),r=n.n(o),a=n("gOKa"),i=n("Ua4J"),s=n("/FQd"),c=n("bR0+");const l=new a.b({url:"/gateway/api/directory/graphql",cacheSize:100,cacheMaxAge:3e5}),d=({position:e="bottom-start",userId:t,isAnonymous:n=!1,canViewProfile:d=!0,children:u,trigger:p="hover"})=>{const{push:h}=Object(o.useContext)(i.a);return r.a.createElement(s.a,null,({userId:o,cloudId:i})=>{return s=o,!n&&d&&t&&s?r.a.createElement(a.a,{cloudId:i,userId:t,resourceClient:l,position:e,trigger:p,actions:[{label:"View profile",id:"view-profile",callback:()=>(async e=>{const t=await Object(c.b)(e);h(t)})(t),shouldRender:e=>(e=>!!e&&(e.status&&"inactive"!==e.status))(e)}]},u):u;var s})};d.displayName="ProfileCardWrapper"},bMee:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("rIhL");t.ActivityResource=o.default},gOoR:function(e,t,n){"use strict";var o=n("cxan"),r=n("zjfJ"),a=n("ERkP"),i=n.n(a),s=n("gQ5V"),c=n("/FQd"),l=(n("aWzz"),n("KD1n")),d=n("H5qd"),u=n.n(d);function p(){const e=Object(l.a)(["\n  query WatchContentQuery($contentId: ID!) {\n    content(id: $contentId) {\n      nodes {\n        id\n        currentUserIsWatching\n      }\n    }\n  }\n"]);return p=function(){return e},e}const h=u()(p());function f(){const e=Object(l.a)(["\n  mutation WatchContentMutation($id: ID!) {\n    watchContent(watchContentInput: { contentId: $id, currentUser: true }) {\n      content {\n        id\n        currentUserIsWatching\n      }\n    }\n  }\n"]);return f=function(){return e},e}const m=u()(f());var b=n("pkwY"),v=n("7nmT"),g=n.n(v),C=n("+Aie"),y=n.n(C),w=n("L21V"),E=n("bMee"),P=n("VPHB"),x=n("/sMe"),I=n("oVzP"),O=n("MH0m"),j=n("pU2z"),_=n("zirS"),S=n("m5cL"),k=n("JpEQ"),A=n("2sr0"),R=n("vdYO"),M=n("rGGD"),T=n("YPyD"),D=n("HN9L"),q=n("1Y1u"),W=n("daKX"),z=n("qkqg");class F extends a.PureComponent{constructor(...e){super(...e),Object(r.a)(this,"_dnd",e=>{const t=window.Confluence&&window.Confluence.DragAndDrop;t&&"function"==typeof t[e]&&t[e]()}),Object(r.a)(this,"_enablePlupload",()=>this._dnd("initialise")),Object(r.a)(this,"_disablePlupload",()=>this._dnd("destroy"))}componentDidMount(){this._disablePlupload(),window.document.addEventListener("dragenter",this._disablePlupload),window.document.body.addEventListener("drop",this._disablePlupload)}componentWillUnmount(){window.document.removeEventListener("dragenter",this._disablePlupload),window.document.body.removeEventListener("drop",this._disablePlupload),this._enablePlupload()}render(){return null}}F.displayName="DisablePlUpload";var L=n("KsTJ"),N=n("dDc+");function H(){const e=Object(l.a)(["\n  clear: both;\n"]);return H=function(){return e},e}function U(){const e=Object(l.a)(["\n  padding-top: 10px;\n  padding-bottom: 10px;\n  float: right;\n"]);return U=function(){return e},e}function V(){const e=Object(l.a)(["\n  background-color: white;\n  padding: 8px;\n  border: 1px solid ",";\n  border-radius: 3px;\n\n  .ProseMirror {\n    min-height: 125px;\n  }\n"]);return V=function(){return e},e}function B(){const e=Object(l.a)(["\n  display: flex;\n  flex-grow: 80;\n}\n"]);return B=function(){return e},e}function K(){const e=Object(l.a)(["\n  min-height: 175px;\n"]);return K=function(){return e},e}const J=L.default.div(K()),Q=L.default.div(B()),Y=L.default.div(V(),N.colors.N40);Y.displayName="StyledChromelessCommentEditor";const G=L.default.div(U());G.displayName="StyledChromelessButtonContainer";const $=L.default.div(H());function Z(){const e=Object(l.a)(["Failed to bind key ",""]);return Z=function(){return e},e}const X=Object(W.a)("comment-editor"),ee=Object(A.a)()(class extends a.PureComponent{constructor(...e){super(...e),Object(r.a)(this,"state",{isExpanded:!1,editorSaving:!1,watchContentCheckboxValue:!0,contextIdentifierProvider:Promise.resolve({containerId:this.props.spaceId,objectId:this.props.contentId,product:"confluence"}),mediaProvider:null,mentionProvider:Object(M.a)(this.props.cloudId,this.props.userId).then(e=>e.mentionResource).catch(e=>Promise.reject()),emojiProvider:Object(T.a)(k.a,{cloudId:this.props.cloudId,source:"edit",userId:this.props.userId}),activityProvider:Promise.resolve(new E.ActivityResource("/gateway/api/activity/",this.props.cloudId)),cardProvider:Promise.resolve(new D.a)}),Object(r.a)(this,"commentContainer",i.a.createRef()),Object(r.a)(this,"isEditorAborted",!1),Object(r.a)(this,"hasContent",!1),Object(r.a)(this,"codeBlockConfiguration",{enableKeybindingsForIDE:!0}),Object(r.a)(this,"tableConfiguration",{allowBackgroundColor:!0,allowColumnResizing:!0,allowHeaderColumn:!0,allowHeaderRow:!0,allowMergeCells:!0,allowNumberColumn:!0,allowControls:!0,permittedLayouts:"all",stickToolbarToBottom:!0}),Object(r.a)(this,"checkContentAndShowDialog",e=>{this.hasContent&&(e.preventDefault(),e.returnValue="")}),Object(r.a)(this,"initializeMousetrap",()=>{this.mousetrap=new y.a(g.a.findDOMNode(this))}),Object(r.a)(this,"onSubmit",e=>()=>{const{saveHandler:t,shouldWatch:n}=this.props;this.setState({editorSaving:!0}),e.getValue().then(e=>{null!==e&&(t({adf:e}),this.hasContent=!1,n&&this.updateWatchSettings())})}),Object(r.a)(this,"onCancel",()=>{const{cancelHandler:e}=this.props;this.isEditorAborted=!0,e({isEditorAborted:!0})}),Object(r.a)(this,"preventEvent",e=>{e.stopPropagation()}),Object(r.a)(this,"cancelExternalEventHandlers",e=>{try{const t=e.key&&e.key.toLowerCase();this.mousetrap.bind(t,this.preventEvent)}catch(e){X.error(Z(),e)}}),Object(r.a)(this,"getMediaOptions",()=>({provider:this.state.mediaProvider,allowMediaSingle:!0,allowResizing:!0,allowAnnotation:!1})),Object(r.a)(this,"fireAnalyticsEvent",()=>{const{watchContentCheckboxValue:e}=this.state,{contentType:t,createAnalyticsEvent:n,contentId:o}=this.props;n({type:"sendTrackEvent",data:{action:e?"watched":"unwatched",actionSubject:t,actionSubjectId:o,source:"comment",attributes:{editor:"v2"}}}).fire()}),Object(r.a)(this,"updateWatchSettings",()=>{const{watchContent:e,contentId:t}=this.props,{watchContentCheckboxValue:n}=this.state;n&&e({variables:{id:t}}),this.fireAnalyticsEvent()}),Object(r.a)(this,"handleToggle",e=>{this.setState({watchContentCheckboxValue:e.target.checked})}),Object(r.a)(this,"getSecondaryToolbar",()=>{const{shouldWatch:e}=this.props,{editorSaving:t}=this.state;return e?i.a.createElement(Q,null,i.a.createElement(w.c,{id:"comment-editor.notification.enable",defaultMessage:"Watch this page",description:"Label to watch Page for Fabric Comment"},e=>i.a.createElement(I.a,{testId:"comment-watch-checkbox",label:e,defaultChecked:!0,isDisabled:t,onChange:this.handleToggle}))):null}),Object(r.a)(this,"onContentChange",e=>()=>{this.props.onContentChange(),e.getValue().then(e=>{null===e||Object(z.a)(e)?this.hasContent=!1:this.hasContent=!0})})}static getDerivedStateFromProps(e,t){const{error:n,contentId:o,contentType:r,userId:a}=e,{prevError:i}=t,s=a?Object(q.b)({contentId:o,contentType:r}):null,c=Object(b.a)({},t,{prevError:n,mediaProvider:s});return n!==i&&(c.editorSaving=!1),c}componentDidMount(){const{onEditorLoaded:e,afterActivate:t}=this.props;this.initializeMousetrap(),e(),t(this.commentContainer.current),window.addEventListener("beforeunload",e=>{this.checkContentAndShowDialog(e)})}componentWillUnmount(){const{editorSaving:e}=this.state,{cancelHandler:t}=this.props;e||this.isEditorAborted||t({isEditorAborted:!1}),this.mousetrap.reset(),this.hasContent=!1,window.removeEventListener("beforeunload",e=>{this.checkContentAndShowDialog(e)})}renderEditor(e){const{content:t,chromeless:n,showCancelButton:r}=this.props,{mentionProvider:s,emojiProvider:c,editorSaving:l,activityProvider:d,contextIdentifierProvider:u,cardProvider:p}=this.state,{featureFlags:h}=this.props,f="confluence.frontend.fabric.editor.native.expands",m=Boolean(h["".concat(f,".collapsible")]);let b;b=h["".concat(f,".insert.comments")]?{allowInsertion:!0,allowInteractiveExpand:m}:!!h["".concat(f,".render")]&&{allowInsertion:!1,allowInteractiveExpand:m};const v={disabled:l,defaultValue:t,media:this.getMediaOptions(),mentionProvider:s,emojiProvider:c,activityProvider:d,contextIdentifierProvider:u,waitForMediaUpload:!0,shouldFocus:!0,allowTextColor:!0,allowLists:!0,allowCodeBlocks:this.codeBlockConfiguration,allowRule:!0,allowTables:this.tableConfiguration,allowPanel:!0,allowStatus:!0,allowDate:!0,allowIndentation:!0,allowAnalyticsGASV3:!0,quickInsert:!0,allowExpand:b,onChange:this.onContentChange(e),UNSAFE_cards:{provider:p},onSave:this.onSubmit(e)};return n?i.a.createElement(a.Fragment,null,i.a.createElement(Y,null,i.a.createElement(O.a,Object(o.a)({},v,{appearance:"chromeless"}))),i.a.createElement(G,null,i.a.createElement(P.a,null,i.a.createElement(x.a,{appearance:"primary",isDisabled:l,onClick:this.onSubmit(e),testId:"inlineCommentSaveButton"},i.a.createElement(w.c,{id:"comment-editor.inline.button.save",defaultMessage:"Save",description:"Button label for save button for inline comments"})),r&&i.a.createElement(x.a,{appearance:"subtle",onClick:this.onCancel,testId:"inlineCommentCancelButton"},i.a.createElement(w.c,{id:"comment-editor.inline.button.cancel",defaultMessage:"Cancel",description:"Button label for cancel button for inline comments"})))),i.a.createElement($,null)):i.a.createElement(j.a,{isExpanded:!0},i.a.createElement(O.a,Object(o.a)({},v,{appearance:"comment",onCancel:this.onCancel,secondaryToolbarComponents:this.getSecondaryToolbar()})))}render(){return i.a.createElement(R.d,null,i.a.createElement(a.Fragment,null,i.a.createElement(F,null),i.a.createElement("div",{ref:this.commentContainer},i.a.createElement(J,{onKeyDown:this.cancelExternalEventHandlers,onKeyUp:this.cancelExternalEventHandlers,onKeyPress:this.cancelExternalEventHandlers},i.a.createElement(_.a,null,i.a.createElement(S.a,{render:e=>this.renderEditor(e)}))))))}});n.d(t,"a",(function(){return te}));class te extends a.PureComponent{constructor(...e){super(...e),Object(r.a)(this,"updateWatchContent",(e,{data:{watchContent:t}})=>{const{contentId:n}=this.props,o=e.readQuery({query:h,variables:{contentId:n}});o.content.nodes[0].currentUserIsWatching=t.content.currentUserIsWatching,e.writeQuery({query:h,data:o})})}render(){const{contentId:e,shouldWatch:t,chromeless:n,showCancelButton:r}=this.props;return i.a.createElement(c.a,null,({cloudId:a,userId:c,featureFlags:l})=>!t||!c?i.a.createElement(ee,Object(o.a)({},this.props,{cloudId:a,userId:c,shouldWatch:!1,chromeless:n,showCancelButton:r,featureFlags:l})):i.a.createElement(s.b,{query:h,variables:{contentId:e}},({data:e,loading:t,error:d})=>{var u;if(d||t)return null;const p=(null!=(u=e)&&null!=(u=u.content)&&null!=(u=u.nodes)&&null!=(u=u[0])?u.currentUserIsWatching:u)||!1;return i.a.createElement(s.a,{mutation:m,update:this.updateWatchContent},e=>i.a.createElement(ee,Object(o.a)({},this.props,{cloudId:a,userId:c,shouldWatch:!p,chromeless:n,showCancelButton:r,watchContent:e,featureFlags:l})))}))}}te.displayName="CommentEditor",Object(r.a)(te,"defaultProps",{shouldWatch:!1,chromeless:!1,showCancelButton:!1,saveHandler:()=>{},cancelHandler:()=>{},onEditorLoaded:()=>{},afterActivate:()=>{},onContentChange:()=>{}})},hATe:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n("ERkP"),r=n.n(o),a=n("bz/o"),i=n("7M9M"),s=n("TVRZ");const c=({userId:e,canViewProfile:t=!0,isAnonymous:n=!1,size:c="medium",src:l,trigger:d})=>{const[u,p]=Object(o.useState)(l);return Object(o.useEffect)(()=>{p(!n&&t&&l?l:"".concat(i.CONTEXT_PATH,"/images/icons/profilepics/anonymous.png"))},[n,t,l]),r.a.createElement(s.a,{userId:e,canViewProfile:t,isAnonymous:n,trigger:d},r.a.createElement(a.a,{src:u,size:c,target:"_blank",enableTooltip:!t}))};c.displayName="ProfileAvatar"},itm6:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildCredentials=function(e){return e&&e.omitCredentials?"omit":"include"}},pU2z:function(e,t,n){"use strict";var o,r=n("D57K"),a=n("ERkP"),i=n("MH0m"),s=n("aWzz"),c=n("zirS"),l=n("m5cL"),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSave=function(e){return function(){t.props.onSave(e)}},t.handleCancel=function(e){return function(){t.props.onCancel(e)}},t.handleChange=function(e){return function(){t.props.onChange(e)}},t}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this;if(this.context.editorActions){var t=this.context.editorActions;return a.createElement(i.a,Object(r.__assign)({},this.props,{onSave:this.props.onSave?this.handleSave(t):void 0,onChange:this.props.onChange?this.handleChange(t):void 0,onCancel:this.props.onCancel?this.handleCancel(t):void 0}))}return a.createElement(c.a,null,a.createElement(l.a,{render:function(t){return a.createElement(i.a,Object(r.__assign)({},e.props,{onSave:e.props.onSave?e.handleSave(t):void 0,onChange:e.props.onChange?e.handleChange(t):void 0,onCancel:e.props.onCancel?e.handleCancel(t):void 0}))}}))},t.contextTypes={editorActions:s.object.isRequired},t}(a.Component),u=n("KsTJ"),p=n("KR5a"),h=n("RZTm"),f=n("dDc+"),m=u.default.input(o||(o=Object(r.__makeTemplateObject)(["\n  /* Normal .className gets overridden by input[type=text] hence this hack to produce input.className */\n  input& {\n    background-color: white;\n    border: 1px solid ",";\n    border-radius: ","px;\n    box-sizing: border-box;\n    height: 40px;\n    padding-left: 20px;\n    padding-top: 12px;\n    padding-bottom: 12px;\n    font-size: 14px;\n    width: 100%;\n    font-weight: 400;\n    line-height: 1.42857142857143;\n    letter-spacing: -0.005em;\n    color: ",";\n\n    &:hover {\n      border-color: ",";\n      cursor: text;\n    }\n  }\n"],["\n  /* Normal .className gets overridden by input[type=text] hence this hack to produce input.className */\n  input& {\n    background-color: white;\n    border: 1px solid ",";\n    border-radius: ","px;\n    box-sizing: border-box;\n    height: 40px;\n    padding-left: 20px;\n    padding-top: 12px;\n    padding-bottom: 12px;\n    font-size: 14px;\n    width: 100%;\n    font-weight: 400;\n    line-height: 1.42857142857143;\n    letter-spacing: -0.005em;\n    color: ",";\n\n    &:hover {\n      border-color: ",";\n      cursor: text;\n    }\n  }\n"])),p.d,Object(h.f)(),f.colors.N300,f.colors.N50),b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.focusHandler=function(e){t.input&&t.input.blur(),t.props.onFocus&&t.props.onFocus(e)},t.handleInputRef=function(e){t.input=e},t}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props.text||"Type something…";return a.createElement(m,{innerRef:this.handleInputRef,onFocus:this.focusHandler,placeholder:e})},t}(a.PureComponent),v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleEditorRef=function(e,n){n&&"function"==typeof n&&n(e),t.editorComponent=e},t}return Object(r.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){!this.props.isExpanded&&e.isExpanded&&(this.shouldTriggerExpandEvent=!0)},t.prototype.componentDidUpdate=function(){this.shouldTriggerExpandEvent&&this.editorComponent&&(this.shouldTriggerExpandEvent=!1,this.props.onExpand&&this.props.onExpand())},t.prototype.render=function(){var e=this,t=a.Children.only(this.props.children);if(t.type!==i.a&&t.type!==d)throw new Error("Expected child to be of type `Editor`");return this.props.isExpanded?a.cloneElement(t,{ref:function(n){return e.handleEditorRef(n,t.ref)}}):a.createElement(b,{onFocus:this.props.onFocus,text:this.props.placeholder})},t}(a.Component);t.a=v},qkqg:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));const o=e=>!e||!r(e),r=e=>(e&&e.content).some(i),a=e=>"text"!==e.type||""!==e.text.trim(),i=e=>"paragraph"!==e.type||(e=>!!e.content&&e.content.some(a))(e)},rIhL:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("D57K"),r=n("LUsr"),a=function(){function e(e,t){this.serviceConfig={url:e},this.cloudId=t}return e.prototype.getFrequentItems=function(){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(t){switch(t.label){case 0:return this.frequentPromise||(e={path:"api/frequent",queryParams:{cloudId:this.cloudId},requestInit:{mode:"cors"}},this.frequentPromise=r.utils.requestService(this.serviceConfig,e)),[4,this.frequentPromise];case 1:return[2,t.sent().data]}}))}))},e.prototype.getRecentItems=function(){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(t){switch(t.label){case 0:return this.recentPromise||(e={path:"api/client/recent",queryParams:{cloudId:this.cloudId},requestInit:{mode:"cors"}},this.recentPromise=r.utils.requestService(this.serviceConfig,e)),[4,this.recentPromise];case 1:return[2,t.sent().data]}}))}))},e.prototype.searchRecent=function(e){return o.__awaiter(this,void 0,void 0,(function(){var t;return o.__generator(this,(function(n){switch(n.label){case 0:return[4,this.getRecentItems()];case 1:return t=n.sent(),[2,this.filterItems(t,e)]}}))}))},e.prototype.filterItems=function(e,t){return 0===t.length?[]:(t=t.toLowerCase(),e.filter((function(e){return e.name.toLowerCase().indexOf(t)>-1})))},e}();t.default=a}}]);
//# sourceMappingURL=63.Y4LHW1WF-v39.js.map