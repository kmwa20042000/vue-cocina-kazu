WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:confluence-macro-api-v5', location = 'v5/js/confluence/utils.js' */
define("ac/confluence/utils",["document"],function(a){return{isFabricEditor:function(){return 0<a.querySelectorAll("[data-fabric-mode]").length}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:confluence-macro-api-v5', location = 'v5/js/confluence/macro/macro.js' */
define("ac/confluence/macro",["confluence/root","ajs","ac/confluence/utils"],function(m,g,n){function h(){var a=require("confluence-macro-browser/macro-browser");void 0===a&&(a={getMacroName:function(a){},getMacroParams:function(a){},getMacroBody:function(){throw Error("confluence-macro-browser/macro-browser is unavailable");}});return a}function k(a){var b=a.indexOf("\x3d");if(0<b){var c=a.slice(0,b);a=a.slice(b+1);return{key:c,value:a}}return{}}function l(a){return a.split("|").reduce(function(a,
b){var c=k(b);c.key&&(a[c.key]=c.value);return a},{})}var d=void 0,b={};return{convertRawParamToObject:k,convertRawParamSeriesToObject:l,getMacroBody:function(a){if(g.DarkFeatures.isEnabled("fabric.editor.fix-get-macro-methods")){var e=a._context.extension.options.productContext["macro.id"],c=$('[data-fabric-macro\x3d"'+e+'"]');if(c.length)a(c.attr("data-macro-body")||"");else if(b&&"string"===typeof b.body)a(b.body);else try{var f=h().getMacroBody(),d=$($.parseXML('\x3croot xmlns:ac\x3d"guid"\x3e'+
f+"\x3c/root\x3e")).find("[ac\\:macro-id\x3d'"+e+"']");1==d.length?a(d.html().replace('xmlns:ac\x3d"guid"',"")):a(f)}catch(p){c=a._context.extension.options.productContext,"false"===c["macro.truncated"]?a(c["macro.body"]):(f=c["page.id"],d=c["page.version"],g.$.ajax({url:g.contextPath()+"/rest/api/content/"+f+"/history/"+d+"/macro/id/"+e,dataType:"json",success:function(b){a(b.body)}}))}}else if(b&&"string"===typeof b.body)a(b.body);else try{f=h().getMacroBody(),e=a._context.extension.options.productContext["macro.id"],
d=$($.parseXML('\x3croot xmlns:ac\x3d"guid"\x3e'+f+"\x3c/root\x3e")).find("[ac\\:macro-id\x3d'"+e+"']"),1==d.length?a(d.html().replace('xmlns:ac\x3d"guid"',"")):a(f)}catch(p){c=a._context.extension.options.productContext,"false"===c["macro.truncated"]?a(c["macro.body"]):(f=c["page.id"],d=c["page.version"],e=c["macro.id"],g.$.ajax({url:g.contextPath()+"/rest/api/content/"+f+"/history/"+d+"/macro/id/"+e,dataType:"json",success:function(b){a(b.body)}}))}},closeCurrentMacroPropertyPanel:function(){g.Confluence.PropertyPanel.destroy()},
setLastSelectedConnectMacroNode:function(a){b.locationToInsert=void 0;b.params=void 0;b.body=void 0;b.name=void 0;d=void 0!==h().getMacroName(a)?a:void 0},setUnsavedMacroData:function(a,d,c,f){b.body=d;b.params=c;b.locationToInsert=f;b.name=a},getMacroData:function(a){var e=$('[data-fabric-macro\x3d"'+a._context.extension.options.productContext["macro.id"]+'"]');e.length?a(JSON.parse(e.attr("data-macro-parameters")||"{}")):void 0===d&&b.params?a(b.params):d?a(h().getMacroParams(d)):a(l(a._context.extension.options.productContext[": \x3d | RAW | \x3d :"]||
""))},getCurrentMacroParameters:function(){return void 0===d?b.params:h().getMacroParams(d)},saveMacro:function(){return tinymce.confluence.MacroUtils.updateMacro.apply(this,arguments)},saveCurrentMacro:function(a,e){if(n.isFabricEditor())return require("confluence-macro-browser/macro-browser-facade").insert({name:b.name,params:a,body:e});if(void 0===d){b.params=a;b.body=e;var c={contentId:m.getContentId(),macro:{name:b.name,params:b.params,body:null===b.body?"":b.body}};g.Rte.getEditor().selection.moveToBookmark(b.locationToInsert);
return tinymce.confluence.MacroUtils.insertMacro(c).done(function(a){d=a})}c=h().getMacroName(d);if(void 0!==c)return tinymce.confluence.MacroUtils.updateMacro(a,e,c,d).done(function(a){d=a})}}});
}catch(e){WRMCB(e)};