(window.webpackJsonp=window.webpackJsonp||[]).push([["page-tree~b59ad437"],{"2z5K":function(e,t,n){var a=n("YpBQ"),r=n("S3pA"),i=n("R3TX"),s=n("s+R0"),o=n("Ndl3"),c=n("p1C/"),l=i((function(e){var t=c(e);return o(t)&&(t=void 0),s(a(e,1,o,!0),r(t,2))}));e.exports=l},"44iz":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("HKB3");const r=(e,t=!0)=>((e,t)=>e.getVariantValue("confluence.frontend.nux.onboarding.v1",{default:a.a.NOT_ENROLLED,oneOf:[a.a.EXPERIMENT,a.a.NOT_ENROLLED,a.a.CONTROL],shouldTrackExposureEvent:t}))(e,t)===a.a.EXPERIMENT},Dsoe:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n("ERkP"),r=n("hpu0");class i extends a.Component{constructor(e){super(e),this.markExperienceStart()}markExperienceStart(){const{id:e,name:t,attributes:n,collect:a,onSuccess:i}=this.props;Object(r.a)().start({attributes:n,name:t,id:e,collect:a,onSuccess:i})}render(){return null}}i.displayName="ExperienceStart"},GFmV:function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"b",(function(){return g}));const a="createBlankFabricPage",r="parentPageId",i="spaceKey",s=e=>{const t=e[a];return"string"==typeof t?"true"===t:!!t},o=e=>{const t={};return e[r]&&(t.parentPageId=e[r]),e[i]&&(t.spaceKey=e[i]),t},c=(e,t={})=>({[a]:e||null,[r]:t.parentPageId||null,[i]:t.spaceKey||null}),l=e=>{const t=e["confluence.frontend.fabric.editor.blank.page"]||e["confluence.frontend.fabric.editor.all-pages"],n=e["confluence.frontend.in-editor-templates"];return t&&n},d=(e,t)=>{var n,a,r;if((null!=(r=e)&&null!=(r=r.content)&&null!=(r=r.nodes)&&null!=(r=r[0])&&null!=(r=r.space)?r.key:r)!==t)return!1;if("page"!==(null!=(a=e)&&null!=(a=a.content)&&null!=(a=a.nodes)&&null!=(a=a[0])?a.type:a))return!1;const i=null!=(n=e)&&null!=(n=n.content)&&null!=(n=n.nodes)&&null!=(n=n[0])?n.operations:n;return!!(i&&i.find(e=>"page"===e.targetType&&"create"===e.operation))},g=(e,t)=>({value:e||t,usedOverride:!!e})},HKB3:function(e,t,n){"use strict";let a;n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),function(e){e.NOT_ENROLLED="not-enrolled",e.CONTROL="control",e.EXPERIMENT="experiment"}(a||(a={}));const r=Object.keys(a).map(e=>a[e])},LjTg:function(e,t,n){"use strict";n("aWzz");var a=n("ERkP"),r=n.n(a),i=n("gQ5V"),s=n("wKA4"),o=n("KD1n"),c=n("H5qd");function l(){const e=Object(o.a)(["\n  query IsSuperAdmin {\n    user(current: true) {\n      id\n      confluence {\n        roles {\n          isSuperAdmin\n        }\n      }\n    }\n  }\n"]);return l=function(){return e},e}const d=n.n(c)()(l());n.d(t,"a",(function(){return g}));const g=({children:e})=>Object(s.a)()?r.a.createElement(i.b,{query:d},({loading:t,error:n,data:a})=>{var r;return e({loading:t,error:n,isSuperAdmin:Boolean(null!=(r=a)&&null!=(r=r.user)&&null!=(r=r.confluence)&&null!=(r=r.roles)?r.isSuperAdmin:r)})}):e({loading:!1,isSuperAdmin:!1});g.displayName="AdminKeyQuery"},"NK/E":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(n("ERkP")),r=i(n("4KTy"));function i(e){return e&&e.__esModule?e:{default:e}}function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var o=function(e){return a.default.createElement(r.default,s({dangerouslySetGlyph:'<svg width="24" height="24" viewBox="0 0 24 24" focusable="false" role="presentation"><path fill="currentColor" fill-rule="evenodd" d="M8 10V8.002A4.004 4.004 0 0 1 12 4a4 4 0 0 1 4 4.002V10a2 2 0 0 1 2 2v6c0 1.105-.902 2-2.009 2H8.01A2 2 0 0 1 6 18v-6c0-1.102.897-1.995 2-2zm2 0h4V8.002A2.001 2.001 0 0 0 12 6c-1.102 0-2 .898-2 2.002V10zm2 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/></svg>'},e))};o.displayName="LockFilledIcon";var c=o;t.default=c},U3X2:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("KD1n"),r=n("H5qd");function i(){const e=Object(a.a)(['\n  query ContentPropertiesQuery($contentId: ID, $versionOverride: Int) {\n    content(id: $contentId, version: $versionOverride) {\n      nodes {\n        id\n        type\n        metadata {\n          frontend {\n            spaFriendly\n          }\n        }\n        properties(key: "editor") {\n          nodes {\n            id\n            key\n            value\n          }\n        }\n        operations {\n          operation\n          targetType\n        }\n      }\n    }\n  }\n']);return i=function(){return e},e}const s=n.n(r)()(i())},"X+YX":function(e,t,n){var a=n("JBn+"),r=n("OfKG"),i=n("sCL+"),s=n("H87J"),o=n("SU8Q"),c=n("S0iI");e.exports=function(e,t,n,l){var d=-1,g=r,p=!0,u=e.length,h=[],f=t.length;if(!u)return h;n&&(t=s(t,o(n))),l?(g=i,p=!1):t.length>=200&&(g=c,p=!1,t=new a(t));e:for(;++d<u;){var b=e[d],m=null==n?b:n(b);if(b=l||0!==b?b:0,p&&m==m){for(var I=f;I--;)if(t[I]===m)continue e;h.push(b)}else g(t,m,l)||h.push(b)}return h}},c2NM:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(n("ERkP")),r=i(n("4KTy"));function i(e){return e&&e.__esModule?e:{default:e}}function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var o=function(e){return a.default.createElement(r.default,s({dangerouslySetGlyph:'<svg width="24" height="24" viewBox="0 0 24 24" focusable="false" role="presentation"><path d="M10 19v-4.5a2 2 0 1 1 4 0V19h4a1 1 0 0 0 1-1v-7.831l-6.293-6.296a1 1 0 0 0-1.414 0L5 10.169V18a1 1 0 0 0 1 1h4zm11-6.83V18a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3v-5.83l-.04.04c-.39.39-1.03.39-1.42 0-.39-.39-.39-1.03 0-1.42l8.339-8.331a3 3 0 0 1 4.242 0l8.339 8.331c.39.39.39 1.03 0 1.42-.39.39-1.03.39-1.42 0l-.04-.04z" fill="currentColor"/></svg>'},e))};o.displayName="HomeIcon";var c=o;t.default=c},jPWM:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n("KD1n"),r=n("H5qd"),i=n.n(r),s=n("j+hl");function o(){const e=Object(a.a)(["\n  query ContentRendererQuery($contentId: ID) {\n    content(id: $contentId) {\n      nodes {\n        id\n        body {\n          atlas_doc_format {\n            value\n          }\n        }\n        space {\n          id\n          key\n        }\n        type\n        ...contentAppearancePublishedFragment\n      }\n    }\n  }\n\n  ","\n"]);return o=function(){return e},e}const c=i()(o(),s.b)},nosZ:function(e,t,n){"use strict";n.r(t);var a=n("zjfJ"),r=n("ERkP"),i=n.n(r),s=(n("aWzz"),n("lZoD")),o=n("FdGg"),c=n("X2PC"),l=n("qhEF"),d=n("+mzV"),g=n("++l3"),p=n("Ua4J"),u=n("LjTg"),h=n("8TdO"),f=n("Dsoe"),b=n("3VMZ"),m=n("pkwY"),I=n("6R5o"),P=n.n(I),v=n("nnRT"),y=n.n(v),E=n("L21V"),O=n("IC1n"),C=n.n(O),S=n("2sr0"),j=n("0rLj"),w=n("GFmV"),x=n("/MSF"),T=n("44iz"),D=n("hpu0"),k=n("7M9M"),A=n("/FQd"),R=n("+CY+");const L=(e,t,n,a)=>{const r={type:"sendUIEvent",data:{containerType:"space",containerId:t,objectType:"page",action:e,actionSubject:"pageTree",source:n?"pageTreeDrawer":"containerNavigation",attributes:{navigationLayer:"container"}}};return a&&(r.data.attributes.navdexPointType=a),r};var M=n("6BAR"),N=n("2z5K"),F=n.n(N);const _=e=>e&&e.nodes&&e.nodes.length?e.nodes:[],K=e=>e.map(e=>e.id),$=(e,t,n)=>{const a=e[t];if(!(n&&e&&t&&a))return"VIRTUAL_ROOT_ID";switch(t){case n:return n;case"VIRTUAL_LOCAL_ROOT_ID":return"VIRTUAL_LOCAL_ROOT_ID";default:return $(e,a.parentId,n)}},U=e=>!e.hasChildren||Boolean(e.children)&&e.children.length>0,q=(e,t)=>Object(M.a)(e,n=>{for(const a in t){const r=e[a],i=t[a];if(r){const e=U(i)?i.children:r.children;n[a]=Object(m.a)({},i,{parentId:r.parentId,children:e})}else n[a]=i}return n}),V=e=>{const{previousSiblings:t,followingSiblings:n,children:a,nearestAncestors:r}=e;return r.nodes.filter(e=>e.previousSiblings.pageInfo.hasNextPage||e.followingSiblings.pageInfo.hasNextPage).length>0||t.pageInfo.hasNextPage||n.pageInfo.hasNextPage||a.pageInfo.hasNextPage},z=(e,t,n)=>{if(t[e]){const{parentId:a}=t[e];if(a)return n.add(a),z(a,t,n)}return n},B=(e,t)=>{if(!e)return t;const{previousSiblings:n,followingSiblings:a,nearestAncestors:r,children:i}=e,s={},{endCursor:o}=n.pageInfo;s.previousSiblingsCursor=o||t.previousSiblingsCursor;const{endCursor:c}=a.pageInfo;s.followingSiblingsCursor=c||t.followingSiblingsCursor;const{endCursor:l}=r.pageInfo;s.nearestAncestorsCursor=l||t.nearestAncestorsCursor;const{endCursor:d}=i.pageInfo;s.childrenCursor=d||t.childrenCursor;const g=r.nodes.filter(e=>e.previousSiblings.pageInfo.hasNextPage),p=g.length>0?g[0].previousSiblings.pageInfo.endCursor:null;s.naPreviousSiblingsCursor=p||t.naPreviousSiblingsCursor;const u=r.nodes.filter(e=>e.followingSiblings.pageInfo.hasNextPage),h=u.length>0?u[0].followingSiblings.pageInfo.endCursor:null;return s.naFollowingSiblingsCursor=h||t.naFollowingSiblingsCursor,s};var H=n("uUTq"),Q=n.n(H);const G=e=>({id:e.id,children:_(e.children),parentId:null,hasChildren:e.hasChildren,isExpanded:!1,isChildrenLoading:!1,hasRestrictions:e.hasRestrictions||!1,hasInheritedRestrictions:e.hasInheritedRestrictions||!1,data:{title:e.title,webui:e.links.webui}}),X=(e,t={})=>{if(!e)return;const n=_(e.children),a=_(e.nearestAncestors),r=[..._(e.previousSiblings),..._(e.followingSiblings)];return t[e.id]=G(e),r.forEach(e=>X(e,t)),a.forEach(e=>X(e,t)),n.forEach(e=>X(e,t)),t},W=(e,t={},n=!0)=>{const a=_(e).map(e=>{const n=G(e);return t[e.id]=n,n});return t.VIRTUAL_ROOT_ID={id:"VIRTUAL_ROOT_ID",children:K(a),parentId:null,hasChildren:!0,isExpanded:!0,isChildrenLoading:!1,hasRestrictions:!1,hasInheritedRestrictions:!1,data:{title:"",webui:""}},t.VIRTUAL_LOCAL_ROOT_ID={id:"VIRTUAL_LOCAL_ROOT_ID",children:[],parentId:"VIRTUAL_ROOT_ID",hasChildren:!0,isExpanded:!0,isChildrenLoading:!1,hasRestrictions:!1,hasInheritedRestrictions:!1,data:{title:"",webui:""}},n&&(t=Y(t)),t},J=(e,t)=>{let n={};if(!e)return n;n=X(e,n),n=W(t,n,!1);const a=_(e.nearestAncestors),r=_(e.children),i=[...[..._(e.previousSiblings)].reverse(),{id:e.id,children:r},..._(e.followingSiblings)];if(a.forEach((e,t)=>{let r=[];if(0===t)r=i;else{const e=a[t-1];r=[...[..._(e.previousSiblings)].reverse(),e,..._(e.followingSiblings)]}n[e.id].children=K(r)}),n[e.id].children=K(r),a.length){const e=a[a.length-1],t=[...[..._(e.previousSiblings)].reverse(),e,..._(e.followingSiblings)];n.VIRTUAL_LOCAL_ROOT_ID.children=K(t)}return n=Y(n),n},Y=e=>Object(M.a)(e,e=>{Object.keys(e).forEach(t=>{const n=e[t];n&&n.children&&n.children.length&&n.children.forEach(t=>{"string"!=typeof t||"VIRTUAL_LOCAL_ROOT_ID"===n.id&&"VIRTUAL_ROOT_ID"===e[t].parentId||(e[t].parentId=n.id)})})}),Z=(e,t,n)=>Object(M.a)(e,e=>{t.forEach(t=>{if(e[t]&&e[t].parentId&&e[t].parentId!==n){const n=e[e[t].parentId];n.children=Q()(n.children,t)}})}),ee=Object(E.g)({flagErrorTitle:{id:"page-tree.dragndrop.failed.title",defaultMessage:"Something went wrong."},flagErrorDescription:{id:"page-tree.dragndrop.failed.description",defaultMessage:"Refresh the page and try again. If this keeps happening, let us know using the link below."},flagErrorAction:{id:"page-tree.dragndrop.failed.action.visitsupport",defaultMessage:"Visit Atlassian Support"},flagUndoTitle:{id:"page-tree.dragndrop.undo.title",defaultMessage:'Moved "{pageTitle}"',description:"The page is moved on the page tree"},flagUndoAction:{id:"page-tree.dragndrop.undo.action",defaultMessage:"Undo",description:"Action to revert drag&drop movement on the page tree"},flagLargePageTreeTitle:{id:"page-tree.dragndrop.lpt.title",defaultMessage:"Too many pages",description:"Message when there are too many pages in the page tree"},flagLargePageTreeDescription:{id:"page-tree.dragndrop.lpt.description",defaultMessage:"You are trying to drag a page while viewing too many pages at once. To reorder, visit your space settings.",description:"Message when there are too many pages in the page tree"},flagLargePageTreeAction:{id:"page-tree.dragndrop.lpt.action",defaultMessage:"Reorder pages",description:"Link to page Reorder Pages within Space settings"}});var te=n("KD1n"),ne=n("H5qd"),ae=n.n(ne);function re(){const e=Object(te.a)(["\n  mutation MovePageAfterMutation($pageId: ID!, $siblingId: ID!) {\n    movePageAfter(input: { pageId: $pageId, siblingId: $siblingId }) {\n      page {\n        id\n      }\n    }\n  }\n"]);return re=function(){return e},e}const ie=ae()(re());function se(){const e=Object(te.a)(["\n  mutation MovePageAppendMutation($pageId: ID!, $parentId: ID!) {\n    movePageAppend(input: { pageId: $pageId, parentId: $parentId }) {\n      page {\n        id\n      }\n    }\n  }\n"]);return se=function(){return e},e}const oe=ae()(se());function ce(){const e=Object(te.a)(["\n  mutation MovePageBeforeMutation($pageId: ID!, $siblingId: ID!) {\n    movePageBefore(input: { pageId: $pageId, siblingId: $siblingId }) {\n      page {\n        id\n      }\n    }\n  }\n"]);return ce=function(){return e},e}const le=ae()(ce());class de{constructor(e=1){Object(a.a)(this,"pop",()=>this.stack.pop()),Object(a.a)(this,"peek",()=>this.stack.slice(-1)[0]),this.size=e,this.stack=[]}push(e,t,n,a){const r=e[t.parentId],i=r.children[t.index],s=r.children.length>1?t:{parentId:t.parentId};this.stack.push({pageId:i,source:n,destination:s,flagId:a}),this.stack=this.stack.slice(-1*this.size)}}function ge(){const e=Object(te.a)(["\n  query PageTreeChildren($contentId: ID!, $first: Int, $after: String) {\n    page(id: $contentId) {\n      ...PageInfoFragment\n      children(first: $first, after: $after) {\n        count\n        nodes {\n          ...PageInfoFragment\n        }\n        pageInfo {\n          hasNextPage\n          endCursor\n        }\n      }\n    }\n  }\n\n  ","\n"]);return ge=function(){return e},e}function pe(){const e=Object(te.a)(["\n  fragment PageInfoFragment on Page {\n    id\n    title\n    hasChildren\n    hasRestrictions\n    hasInheritedRestrictions\n    links {\n      webui\n    }\n  }\n"]);return pe=function(){return e},e}const ue=ae()(pe()),he=ae()(ge(),ue);var fe=n("cxan"),be=n("Iy7w"),me=n("gQ5V"),Ie=n("9rbw"),Pe=n("/sMe"),ve=n("H314"),ye=n("IJlJ"),Ee=n("0Dc1"),Oe=n("XVWa"),Ce=n("ltac"),Se=n("vitU");var je=n("MV18"),we=n("Aqh1"),xe=n("HZU1");function Te(){const e=Object(te.a)(["\n  query PageTreeGetOnboardingStatusQuery @experimental {\n    experimentalGetCompleteOnboarding {\n      complete\n    }\n  }\n"]);return Te=function(){return e},e}const De=ae()(Te());var ke=n("lSUb"),Ae=n("62R8"),Re=n("c2NM"),Le=n.n(Re),Me=n("dDc+"),Ne=n("Ydxy"),Fe=n("PLaw"),_e=n.n(Fe),Ke=n("5ypJ"),$e=n.n(Ke),Ue=n("NK/E"),qe=n.n(Ue),Ve=n("nZDR"),ze=n.n(Ve),Be=n("KkZ4"),He=n("3Z2R"),Qe=n("MjIW");const Ge="com.atlassian.confluence.plugins.confluence-create-content-plugin:header-create-dialog",Xe=Object(E.g)({label:{id:"contextual-create.label",description:"Label for button that creates pages",defaultMessage:"Create a child page"}}),We=Object(E.h)(Object(r.memo)(({intl:e,parentPageId:t,isCreateBlankFabricPageEnabled:n,spaceKey:a})=>{const{setQueryParams:s}=Object(r.useContext)(p.a),o=e=>{let r;e.preventDefault(),e.stopPropagation(),r=n?Object(w.a)(!0,{parentPageId:t,spaceKey:a}):{createDialog:!0,parentPageId:t},s(r),Object(Be.getAnalyticsWebClient)().then(e=>{e.sendTrackEvent({action:"clicked",actionSubject:"button",source:"contextualCreate"})})},c=e.formatMessage(Xe.label);return i.a.createElement(He.a,{location:Qe.a.SYSTEM_HEADER_LEFT_BUTTON_GROUP,allowedWebItems:[Ge]},({webItems:e,loading:t})=>{if(t||!e||!e.length)return null;const n=e.find(e=>e.completeKey===Ge);return n?i.a.createElement(ye.a,{content:c,key:n.moduleKey,position:"right"},i.a.createElement(Pe.a,{appearance:"subtle",iconBefore:i.a.createElement(ze.a,{size:"small",label:c}),onClick:o})):null})})),Je=({children:e,delay:t})=>{const[n,a]=Object(r.useState)(!1);return Object(r.useEffect)(()=>{const e=setTimeout(()=>a(!0),t>0?t:0);return()=>clearTimeout(e)},[t]),n?i.a.createElement(r.Fragment,null,e):null};var Ye=n("xBRb");const Ze=Object(be.a)("div",{target:"e1o0h2i50"})({name:"1sn8kiq",styles:"display:inline-block;vertical-align:middle;margin-right:5px;"}),et=Object(r.memo)(Object(be.a)("div",{target:"e1o0h2i51"})("width:24px;text-align:center;font-size:12pt;color:",e=>e.itemIsRestricted?Me.colors.R400:"inherit",";")),tt=Object(be.a)("div",{target:"e1o0h2i52"})({name:"5hz1ob",styles:"margin:0 4px;"}),nt=Object(E.g)({restrictionsIconLabel:{id:"page-tree.restricted-content.icon",description:"aria-label for the restricted content icon",defaultMessage:"Restricted Content Icon"}});class at extends r.PureComponent{constructor(...e){super(...e),Object(a.a)(this,"getText",()=>{var e;const{item:t}=this.props,n=(null!=(e=t)&&null!=(e=e.data)?e.title:e)||"";return t.id===this.props.spaceHomePageId?i.a.createElement("span",null,i.a.createElement(Ze,null,i.a.createElement(Le.a,{label:"",size:"small"})),n):n}),Object(a.a)(this,"visitPage",e=>{const{isInDrawer:t,createAnalyticsEvent:n,item:a,spaceId:r,onClick:i}=this.props;n(L("clicked",r,t,Ye.a.START_TOUCH)).fire(),e.metaKey||e.shiftKey||e.altKey||e.ctrlKey||1===e.button||(e.preventDefault(),i(a))}),Object(a.a)(this,"onIconClickExpand",e=>{const{item:t,onExpand:n}=this.props;e.preventDefault(),e.stopPropagation(),n(t.id)}),Object(a.a)(this,"onIconClickCollapse",e=>{const{item:t,onCollapse:n}=this.props;e.preventDefault(),e.stopPropagation(),n(t.id)}),Object(a.a)(this,"getIcon",Object(ke.a)((e,t)=>()=>{const{isChildrenLoading:n,hasChildren:a,isExpanded:r,hasRestrictions:s,hasInheritedRestrictions:o}=e,c=(s||o)&&t,l=c?Me.colors.R400:null;return n?i.a.createElement(tt,null,i.a.createElement(Ne.a,{size:16})):a?r?i.a.createElement("div",{role:"button",tabIndex:"0",onClick:this.onIconClickCollapse},i.a.createElement(_e.a,{primaryColor:l,label:"",size:"medium"})):i.a.createElement("div",{role:"button",tabIndex:"0",onClick:this.onIconClickExpand},i.a.createElement($e.a,{primaryColor:l,label:"",size:"medium"})):i.a.createElement(et,{itemIsRestricted:c},"•")})),Object(a.a)(this,"getAfterIcon",({isHover:e})=>{const{isContextualCreateEnabled:t,isCreateBlankFabricPageEnabled:n,isSuperAdmin:a,spaceKey:r,item:s}=this.props,{hasRestrictions:o,hasInheritedRestrictions:c}=s;return t&&e?i.a.createElement(Je,{delay:200,key:"contextual-create"},i.a.createElement(We,{parentPageId:s.id,isCreateBlankFabricPageEnabled:n,spaceKey:r})):a&&o&&!c?i.a.createElement(qe.a,{primaryColor:Me.colors.R400,key:"super-admin",label:this.props.intl.formatMessage(nt.restrictionsIconLabel)}):null}),Object(a.a)(this,"getItemStyle",e=>{const{snapshot:t,item:n,isSuperAdmin:a}=this.props,{hasRestrictions:r,hasInheritedRestrictions:i}=n,s=Object(m.a)({},e);return s.itemBase["&:hover"]={backgroundColor:Me.colors.N30},s.itemBase.backgroundColor="transparent",s.beforeWrapper.marginRight=4,a&&(r||i)&&(s.textWrapper.color=Me.colors.R400),t.isDragging&&(s.itemBase.boxShadow="".concat(Me.colors.N60A," 1px 5px 11px 2px"),s.itemBase.borderRadius=5,s.itemBase.backgroundColor=Me.colors.N30),t.combineTargetFor&&(s.itemBase.backgroundColor=Me.colors.N30),t.isDragging&&!t.draggingOver&&(s.textWrapper.color=Me.colors.N80,s.beforeWrapper.color=Me.colors.N80),s})}render(){var e,t;const{item:n,isSuperAdmin:a}=this.props,r=null!=(t=n)&&null!=(t=t.data)?t.isSelected:t,s="".concat(k.CONTEXT_PATH).concat(null!=(e=n)&&null!=(e=e.data)?e.webui:e);return i.a.createElement(Ae.a,{href:s,spacing:"compact",isSelected:r,text:this.getText(),before:this.getIcon(n,a),after:this.getAfterIcon,onClick:this.visitPage,styles:this.getItemStyle})}}at.displayName="PageTreeItem";const rt=Object(be.a)("div",{target:"e13wa1bj0"})({name:"1ly8aii",styles:"display:flex;flex-direction:column;flex-grow:1;flex-shrink:0;align-items:flex-start;"});const it=Object(be.a)("div",{target:"e1o8qdqg0"})({name:"hboir5",styles:"display:flex;width:100%;"}),st=Object(be.a)("div",{target:"e1o8qdqg1"})({name:"14yaxqh",styles:"flex-grow:1;flex-shrink:0;width:100%;display:flex;> div{flex-grow:1;width:100%;}"}),ot=Object(be.a)("div",{target:"e1o8qdqg2"})({name:"1uty0ys",styles:"margin:10px 0 10px 0;width:100%;"}),ct=Object(E.h)(Object(S.a)()(class extends r.PureComponent{constructor(...e){super(...e),Object(a.a)(this,"scrolledItemId",null),Object(a.a)(this,"handleOnboardingStatusError",()=>{const{createAnalyticsEvent:e}=this.props;e({type:"sendTrackEvent",data:{name:"onboardingStatusQueryFailed",action:"failed",actionSubject:"pageTree",actionSubjectId:"containerNavigation"}}).fire()}),Object(a.a)(this,"collapsePage",e=>{const{isInDrawer:t,tree:n,createAnalyticsEvent:a}=this.props;a(L("collapsed",this.props.spaceId,t)).fire(),this.props.onCollapse(n.items[e])}),Object(a.a)(this,"expandPage",e=>{const{isInDrawer:t,tree:n,createAnalyticsEvent:a}=this.props;a(L("expanded",this.props.spaceId,t)).fire(),this.props.onExpand(n.items[e])}),Object(a.a)(this,"dragStart",async e=>{const{onDragStart:t,createAnalyticsEvent:n}=this.props;t(e),n({type:"sendUIEvent",data:{action:"dragged",actionSubject:"pageTree",source:"viewPageScreen"}}).fire()}),Object(a.a)(this,"dragEnd",async(e,t)=>{const{onDragEnd:n,createAnalyticsEvent:a}=this.props;var r;n(e,t),a((r=!!t,{type:"sendUIEvent",data:{action:"dropped",actionSubject:"pageTree",source:"viewPageScreen",attributes:{isValidTarget:r}}})).fire()}),Object(a.a)(this,"patchInnerRef",(e,t)=>e.data.isSelected?n=>{t.innerRef(n),setTimeout(()=>this.scrollToItem(e.id,n),0)}:t.innerRef),Object(a.a)(this,"renderItem",({item:e,onExpand:t,onCollapse:n,provided:a,snapshot:r})=>{const s=this.patchInnerRef(e,a),{isSuperAdmin:o,spaceHomePageId:c,isInDrawer:l,createAnalyticsEvent:d,onClick:g,isCreateBlankFabricPageEnabled:p,spaceKey:u,isContextualCreateEnabled:h}=this.props,f=e.data?e.data.title:"",b=i.a.createElement("div",Object(fe.a)({className:"item","data-test-id":"page-tree-item",ref:s},a.draggableProps,a.dragHandleProps,{onMouseDownCapture:(m=e.id,()=>{Object(Se.a)(m)})}),i.a.createElement(ye.a,{content:f,position:"top",delay:750,hideTooltipOnMouseDown:!0},i.a.createElement(at,{item:e,spaceHomePageId:c,onExpand:t,onCollapse:n,snapshot:r,isSuperAdmin:o,isInDrawer:l,createAnalyticsEvent:d,onClick:g,isContextualCreateEnabled:h,isCreateBlankFabricPageEnabled:p,spaceKey:u,intl:this.props.intl})));var m;return e.data.isSelected?this.addSpotlight(b):b})}startSpotlightTour(e){const{createAnalyticsEvent:t}=this.props;t((e=>({type:"sendOperationalEvent",data:{action:"exposed",actionSubject:"feature",actionSubjectId:"engagement.inproduct.".concat(e),source:"engagement-platform",attributes:{flagKey:"engagement.inproduct.".concat(e)}}}))(e)).fire()}getOnboardingStatus(){return i.a.createElement(me.b,{query:De,onError:this.handleOnboardingStatusError},({data:e})=>{var t;if(Boolean(null!=(t=e)&&null!=(t=t.experimentalGetCompleteOnboarding)?t.complete:t)){const e="EP-1285";this.startSpotlightTour(e)}return null})}scrollToItem(e,t){this.scrolledItemId!==e&&Object(Ce.c)(t),this.scrolledItemId=e}addSpotlight(e){return i.a.createElement(xe.a,{name:"page-tree-spotlight"},e)}render(){const{tree:e,loadMorePages:t,isTreeTruncated:n,isDraggable:a,intl:s,spaceKey:o,currentPageId:c,spaceHomePageId:l,isAnonymousUser:d,showSpaceCardSpotlight:g}=this.props,p=n?i.a.createElement(ot,null,i.a.createElement(Pe.a,{shouldFitContainer:!0,onClick:t},i.a.createElement(E.c,{id:"page-tree.pages.show.all",defaultMessage:"Show all pages"}))):null,u=n?it:st,h=i.a.createElement(ve.a,{heading:Object.keys(e.items).length&&s.formatMessage({id:"pages.word"})},p,!d&&g&&this.getOnboardingStatus(),i.a.createElement(u,null,i.a.createElement(Ie.a,{tree:e,isDragEnabled:a,renderItem:this.renderItem,onExpand:this.expandPage,onCollapse:this.collapsePage,onDragStart:this.dragStart,onDragEnd:this.dragEnd,offsetPerLevel:24,isNestingEnabled:!0}),i.a.createElement(we.a.Consumer,null,({isNav2:e})=>i.a.createElement(r.Fragment,null,i.a.createElement(Ee.a,{subject:Oe.a.navigation,subjectId:"NavigationLoading",details:{navigationView:"container",view:"space",navVersion:e?2:3,spaceKey:o}}),i.a.createElement(Ee.a,{subject:Oe.a.navigationView,subjectId:"SpaceViewLoading",details:{navigationView:"container",view:"space",navVersion:e?2:3,spaceKey:o}}))),i.a.createElement(je.a,{name:b.a.PAGE_TREE})),p);return i.a.createElement(rt,null,c===l?this.addSpotlight(h):h)}}));var lt=n("1whV"),dt=n.n(lt);const gt=Object(be.a)("div",{target:"eyspfzh0"})({name:"8f5jyh",styles:"padding:8px 0px 8px 0px;box-sizing:border-box;height:40px;width:fit-content;"}),pt=Object(be.a)("span",{target:"eyspfzh1"})({name:"1lvfsfo",styles:"padding-left:4px;padding-right:7px;line-height:24px;cursor:default;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:#42526e;"}),ut=Object(be.a)("div",{target:"eyspfzh2"})({name:"k008qs",styles:"display:flex;"}),ht=Object(E.g)({pages:{id:"page-tree.word",defaultMessage:"Pages"},failedLoadTooltip:{id:"page-tree.failed.load.tooltip",defaultMessage:"Hold tight, we’re working on fixing this."},failedLoadContent:{id:"page-tree.failed.load.content",defaultMessage:"Page tree failed to load"}}),ft=Object(E.h)(class extends r.Component{render(){const{intl:e}=this.props;return i.a.createElement(ve.a,{heading:e.formatMessage(ht.pages)},i.a.createElement(gt,null,i.a.createElement(ye.a,{content:e.formatMessage(ht.failedLoadTooltip),position:"bottom"},i.a.createElement(ut,null,i.a.createElement(dt.a,{label:"error",primaryColor:"rgb(191, 38, 0)"}),i.a.createElement(pt,null,e.formatMessage(ht.failedLoadContent))))))}}),bt=Object(be.a)("div",{target:"ey24sbu0"})({name:"xi606m",styles:"text-align:center;"}),mt=Object(E.g)({pages:{id:"page-tree.word",defaultMessage:"Pages"}}),It=Object(E.h)(class extends r.PureComponent{render(){const{intl:e}=this.props;return i.a.createElement(rt,null,i.a.createElement(ve.a,{heading:e.formatMessage(mt.pages)},i.a.createElement(bt,null,i.a.createElement(Ne.a,{size:20}))))}});function Pt(){const e=Object(te.a)(["\n  query PageTree(\n    $spaceKey: String!\n    $contentId: ID!\n    $paginationLimit: Int\n    $nearestAncestorCursor: String\n    $naPreviousSiblingsCursor: String\n    $naFollowingSiblingsCursor: String\n    $previousSiblingsCursor: String\n    $followingSiblingsCursor: String\n    $childrenCursor: String\n  ) {\n    currentPage: page(\n      id: $contentId\n      pageTree: $paginationLimit\n      enablePaging: true\n    ) {\n      ...PageInfoFragment\n      nearestAncestors(after: $nearestAncestorCursor) {\n        count\n        pageInfo {\n          hasNextPage\n          endCursor\n        }\n        nodes {\n          ...PageInfoFragment\n          previousSiblings(after: $naPreviousSiblingsCursor) {\n            ...PageListFragment\n          }\n          followingSiblings(after: $naFollowingSiblingsCursor) {\n            ...PageListFragment\n          }\n        }\n      }\n      previousSiblings(after: $previousSiblingsCursor) {\n        ...PageListFragment\n      }\n      followingSiblings(after: $followingSiblingsCursor) {\n        ...PageListFragment\n      }\n      children(after: $childrenCursor) {\n        ...PageListFragment\n      }\n    }\n    rootLevelPages: pages(spaceKey: $spaceKey) {\n      nodes {\n        ...PageInfoFragment\n      }\n    }\n    space(key: $spaceKey) {\n      id\n      homepage {\n        id\n      }\n      operations {\n        operation\n        targetType\n      }\n    }\n  }\n\n  ","\n  ","\n"]);return Pt=function(){return e},e}function vt(){const e=Object(te.a)(["\n  fragment PageInfoFragment on Page {\n    id\n    title\n    hasChildren\n    hasRestrictions\n    hasInheritedRestrictions\n    links {\n      webui\n    }\n  }\n"]);return vt=function(){return e},e}function yt(){const e=Object(te.a)(["\n  fragment PageListFragment on PaginatedPageList {\n    count\n    nodes {\n      ...PageInfoFragment\n    }\n    pageInfo {\n      hasNextPage\n      endCursor\n    }\n  }\n"]);return yt=function(){return e},e}const Et=ae()(yt()),Ot=ae()(vt()),Ct=ae()(Pt(),Ot,Et);function St(){const e=Object(te.a)(["\n  query PageTreeRootLevelPages($spaceKey: String!) {\n    rootLevelPages: pages(spaceKey: $spaceKey) {\n      nodes {\n        id\n        hasChildren\n        title\n        hasRestrictions\n        hasInheritedRestrictions\n        links {\n          webui\n        }\n      }\n    }\n    space(key: $spaceKey) {\n      id\n      homepage {\n        id\n      }\n      operations {\n        operation\n        targetType\n      }\n    }\n  }\n"]);return St=function(){return e},e}const jt=ae()(St());class wt extends r.Component{constructor(...e){super(...e),Object(a.a)(this,"state",{expandedPages:new Set,loadingPages:new Set,pages:{},space:null,spaceKey:null,rootId:null,initialLoading:!0,loadingMorePages:!1,isTreeTruncated:!1,initialCursors:null,initialPages:null,error:null}),Object(a.a)(this,"querySubscription",null),Object(a.a)(this,"pageMoveHistory",new de),Object(a.a)(this,"queryChildren",(e,t,n={count:0,nodes:[]})=>this.props.apolloClient.query({query:he,variables:{contentId:e,first:100,after:t}}).then(t=>{const{children:a}=t.data.page,r=((e,t)=>({count:e.count+t.count,nodes:[...e.nodes,...t.nodes]}))(n,a);return a.pageInfo.hasNextPage?this.queryChildren(e,a.pageInfo.endCursor,r):r})),Object(a.a)(this,"getPageQueryObservable",(e,t,n=!1)=>{const a=e?Ct:jt,r=e?{contentId:e,spaceKey:t}:{spaceKey:t},i=Object(m.a)({paginationLimit:500},r);return this.props.apolloClient.watchQuery({fetchPolicy:"cache-and-network",query:a,variables:!0===n?i:r})}),Object(a.a)(this,"loadPages",async(e=!1)=>{const{pages:t}=this.state,{currentPageId:n,spaceKey:a}=this.props,r=this.getPageQueryObservable(n,a,e);this.querySubscription=r.subscribe({next:({data:e,loading:n})=>{if(n&&!e&&this.setState({initialLoading:!0}),e&&Object.keys(e).length>0){const{currentPage:n,rootLevelPages:r,space:i}=e,s=n?J(n,r):W(r),o=B(n,{}),c=q(t,s),l=n?n.id:null,d=i.homepage?i.homepage.id:null;this.setState({expandedPages:this.determineInitiallyExpandedPages(s),rootId:$(c,l,d),pages:c,space:i,spaceKey:a,isTreeTruncated:!!n&&V(n),initialCursors:o,initialPages:n})}n||this.setState({initialLoading:!1})},error:e=>this.handleLoadingError(e,b.a.PAGE_TREE)})}),Object(a.a)(this,"loadMorePages",async()=>{const{currentPageId:e,spaceKey:t,createAnalyticsEvent:n}=this.props;n({type:"sendUIEvent",data:{action:"clicked",actionSubject:"button",actionSubjectId:"showAllButton",source:"containerNavigation"}}).fire(),this.setState({loadingMorePages:!0});const{initialCursors:a,initialPages:r}=this.state,{mergedPages:i,rootLevelPages:s}=await this.loadAllPages(e,t,a,r),o=J(i,s);this.setState({spaceKey:t,pages:o,isTreeTruncated:!1,loadingMorePages:!1})}),Object(a.a)(this,"loadAllPages",(e,t,n,a)=>{const r=Ct,i=Object(m.a)({contentId:e,spaceKey:t},n);return this.props.apolloClient.query({query:r,variables:i}).then(r=>{const{data:i,error:s}=r;if(s)this.handleLoadingError(s);else if(i&&Object.keys(i).length>0){const{currentPage:r,rootLevelPages:s}=i,o=((e,t)=>t?Object(M.a)(t,t=>{const{previousSiblings:n,followingSiblings:a,nearestAncestors:r,children:i}=e,{previousSiblings:s,followingSiblings:o,nearestAncestors:c,children:l}=t;s.nodes=F()(s.nodes,n.nodes,"id"),o.nodes=F()(o.nodes,a.nodes,"id"),l.nodes=F()(l.nodes,i.nodes,"id");const d=F()(r.nodes,c.nodes,"id");return c.nodes.forEach(e=>{const t=d.filter(t=>t.id===e.id);if(t.length>0){const{previousSiblings:n,followingSiblings:a}=t[0];n.nodes=F()(e.previousSiblings.nodes,n.nodes,"id"),a.nodes=F()(e.followingSiblings.nodes,a.nodes,"id")}}),c.nodes=d,s.pageInfo.hasNextPage=s.pageInfo.hasNextPage&&n.pageInfo.hasNextPage,o.pageInfo.hasNextPage=o.pageInfo.hasNextPage&&a.pageInfo.hasNextPage,c.pageInfo.hasNextPage=c.pageInfo.hasNextPage&&r.pageInfo.hasNextPage,t}):e)(r,a);if(V(r)){const a=B(r,n);return this.loadAllPages(e,t,a,o)}return{mergedPages:o,rootLevelPages:s}}})}),Object(a.a)(this,"determineInitiallyExpandedPages",e=>{const{expandedPages:t}=this.state;for(const n in e){const a=e[n];a.hasChildren&&U(a)&&t.add(a.id)}return t}),Object(a.a)(this,"expandPage",async e=>{const{expandedPages:t}=this.state;if(!t.has(e.id)&&e.hasChildren){const{pages:t,expandedPages:n,loadingPages:a}=this.state,r=t[e.id],i=[e.id,...z(e.id,t,n)];if(!U(r)){this.setState({loadingPages:a.add(r.id)});const e={},n=_(await this.queryChildren(r.id));n.forEach(t=>{e[t.id]=G(t)});const i=q(t,e);a.delete(r.id);const s=((e,t,n)=>Object(M.a)(e,e=>{e[t].children=n;const a=Z(e,n,t);Y(a)}))(i,r.id,K(n));this.setState({loadingPages:a,pages:s})}this.setState({expandedPages:new Set(i)})}}),Object(a.a)(this,"collapsePage",e=>{const{expandedPages:t}=this.state;t.delete(e.id),this.setState({expandedPages:t})}),Object(a.a)(this,"visitPage",e=>{const{push:t,onItemClick:n}=this.props;t("".concat(k.CONTEXT_PATH).concat(e.data.webui)),n&&n()}),Object(a.a)(this,"determineMutation",e=>void 0===e.index?oe:0===e.index?le:ie),Object(a.a)(this,"determineMutationVariables",(e,t,n)=>{if(void 0===n.index)return{pageId:t,parentId:n.parentId};const a=0===n.index,r=e[n.parentId].children.indexOf(t),i=r>-1&&r<n.index,s=a||i?n.index:n.index-1;return{pageId:t,siblingId:e[n.parentId].children[s]}}),Object(a.a)(this,"movePage",async(e,t)=>{const{pages:n}=this.state;if(!this.isValidMove(e,t))return void Object(D.a)().abort({name:b.a.PAGE_TREE_DND,reason:"Invalid drop location"});const a=n[e.parentId].children[e.index];this.movePageInState(a,e,t),await this.requestPageMove(n,a,e.parentId,t);const r=await this.showUndoFlag(a);this.pageMoveHistory.push(n,e,t,r.id)}),Object(a.a)(this,"undo",async()=>{const{flags:e}=this.props,{pages:t}=this.state,n=this.pageMoveHistory.pop();if(n){const{pageId:a,source:r,destination:i,flagId:s}=n;return this.movePageInState(a,r,i,!0),e.hideFlag(s),this.requestPageMove(t,a,r.parentId,i)}}),Object(a.a)(this,"handleGenericError",({networkError:e,graphQLErrors:t,lastAction:n,experience:a})=>{const{flags:r,intl:i}=this.props;(e||t&&t.length>0)&&(r.showErrorFlag({title:i.formatMessage(ee.flagErrorTitle),description:i.formatMessage(ee.flagErrorDescription),actions:[{content:i.formatMessage(ee.flagErrorAction),onClick:()=>{window.open(x.a,"_blank")}}]}),console.error("PageTree error",{networkError:e,graphQLErrors:t}),a&&Object(D.a)().fail({name:a,error:{networkError:e,graphQLErrors:t}}),this.setState({error:{networkError:e,graphQLErrors:t,lastAction:n}}))}),Object(a.a)(this,"handleLoadingError",(e,t)=>this.handleGenericError(Object(m.a)({},e,{lastAction:"LOAD",experience:t}))),Object(a.a)(this,"handleDragDropSuccess",(e,t,n)=>()=>{const{createAnalyticsEvent:a,onDragDropSuccess:r}=this.props,{space:i}=this.state;a((({spaceId:e,pageId:t,previousParentPageId:n,newParentPageId:a})=>({type:"sendTrackEvent",data:{action:"updated",source:"viewPageScreen",containerType:"space",containerId:e,objectType:"page",objectId:t,actionSubject:"page",attributes:{previousSpaceId:e,previousParentPageId:n,newSpaceId:e,newParentPageId:a}}}))({spaceId:i.id,pageId:e,previousParentPageId:t,newParentPageId:n})).fire(),Object(D.a)().succeed({name:b.a.PAGE_TREE_DND}),r(e)}),Object(a.a)(this,"handleDragDropError",e=>this.handleGenericError(Object(m.a)({},e,{lastAction:"DND",experience:b.a.PAGE_TREE_DND}))),Object(a.a)(this,"canMovePages",(e,t)=>!!e&&e.operations&&!!P()(e.operations,{targetType:"page",operation:"create"})&&!t),Object(a.a)(this,"showUndoFlag",e=>{const{flags:t,intl:n}=this.props,{pages:a}=this.state;return t.showSuccessFlag({title:n.formatMessage(ee.flagUndoTitle,{pageTitle:a[e].data.title}),actions:[{content:n.formatMessage(ee.flagUndoAction),onClick:this.onUndoFlagClick}]})}),Object(a.a)(this,"onDragStart",()=>{const{pages:e}=this.state;Object(D.a)().start({name:b.a.PAGE_TREE_DND,id:C()()}),Object.keys(e).length>500&&(window.dispatchEvent(new Event("scroll")),this.showLargePageTreeFlag(),Object(D.a)().abort({name:b.a.PAGE_TREE_DND,reason:"Large page tree limit exceeded"})),this.hideLastFlag()}),Object(a.a)(this,"onUndoFlagClick",()=>{const{createAnalyticsEvent:e}=this.props;e({type:"sendUIEvent",data:{action:"clicked",actionSubject:"button",actionSubjectId:"pageTreeDragDropUndo",source:"viewPageScreen"}}).fire(),this.undo()}),Object(a.a)(this,"onUndoShortCut",()=>{const{createAnalyticsEvent:e}=this.props;e({type:"sendUIEvent",data:{action:"pressed",actionSubject:"keyboardShortcut",actionSubjectId:"pageTreeDragDropUndo",source:"viewPageScreen"}}).fire(),this.undo()}),Object(a.a)(this,"hideLastFlag",()=>{const{flags:e}=this.props,t=this.pageMoveHistory.peek();t&&e.hideFlag(t.flagId)}),Object(a.a)(this,"showLargePageTreeFlag",()=>{const{flags:e,intl:t,spaceKey:n,push:a}=this.props;return e.showWarningFlag({title:t.formatMessage(ee.flagLargePageTreeTitle),description:t.formatMessage(ee.flagLargePageTreeDescription),actions:[{content:t.formatMessage(ee.flagLargePageTreeAction),onClick:()=>{a("/wiki/pages/reorderpages.action?key=".concat(n))}}]})})}static getDerivedStateFromProps(e,t){const{currentPageId:n}=e,{expandedPages:a,loadingPages:r,pages:i}=t,s=((e,t,n,a)=>Object(M.a)(e,e=>{for(const r in e)if(e.hasOwnProperty(r)){const i=e[r];i.isExpanded=n.has(r),i.isChildrenLoading=a.has(r),i.data.isSelected=i.id===t}}))(i,n,a,r);return Object(m.a)({},t,{pages:s})}componentDidMount(){this.loadPages(!0)}componentDidUpdate(e){const{currentPageId:t,spaceKey:n}=this.props,{pages:a,spaceKey:r}=this.state,i=a[t];t&&e.currentPageId!==t&&(i&&n===r?this.expandPage(i):this.loadPages(!0))}componentWillUnmount(){this.querySubscription&&this.querySubscription.unsubscribe()}requestPageMove(e,t,n,a){const{apolloClient:r}=this.props,i=this.determineMutation(a),s=this.determineMutationVariables(e,t,a);return r.mutate({mutation:i,variables:s}).then(this.handleDragDropSuccess(t,n,a.parentId)).catch(this.handleDragDropError)}movePageInState(e,t,n,a){const{rootId:r,pages:i,expandedPages:s}=this.state;let o={rootId:r,items:i};if(void 0===t.index){const a=i[t.parentId],r=a.children.indexOf(e);if(-1!==r){const e=[...a.children];e.splice(r,1)[0],o=Object(j.d)(o,t.parentId,{children:e,hasChildren:e.length>0,isExpanded:e.length>0&&a.isExpanded})}const s=[...o.items[n.parentId].children];s.splice(n.index,0,e),o=Object(j.d)(o,n.parentId,{children:s,hasChildren:!0})}else o=Object(j.c)(o,t,n);0===o.items[t.parentId].children.length&&s.delete(t.parentId),a&&s.add(n.parentId),this.setState({pages:o.items,rootId:o.rootId,expandedPages:s})}isValidMove(e,t){const{pages:n}=this.state;return t&&!y()(e,t)&&Object.keys(n).length<500}render(){const{pages:e,rootId:t,space:n,initialLoading:a,loadingMorePages:s,isTreeTruncated:o,error:c}=this.state;if(c&&"LOAD"===c.lastAction)return i.a.createElement(ft,null);if(s||a)return i.a.createElement(It,null);const{currentPageId:l,isDraggable:d,isInDrawer:g,isSuperAdmin:p,spaceKey:u,apolloClient:h}=this.props,f=d&&this.canMovePages(n,c);return i.a.createElement(A.a,null,({featureFlags:a,featureFlagClient:s,locale:c,userId:d})=>{var b;const m=a["confluence.frontend.contextual-create"],I=Object(T.a)(s,!1)&&-1!==c.toLowerCase().indexOf("en",0);return i.a.createElement(r.Fragment,null,i.a.createElement(R.a,{accelerator:"mod+z",listener:this.onUndoShortCut}),i.a.createElement(ct,{isSuperAdmin:p,currentPageId:l,isDraggable:f,isTreeTruncated:o,isInDrawer:g,loadMorePages:this.loadMorePages,onClick:this.visitPage,onCollapse:this.collapsePage,onDragStart:this.onDragStart,onDragEnd:this.movePage,onExpand:this.expandPage,spaceHomePageId:(null!=(b=n)&&null!=(b=b.homepage)?b.id:b)||null,spaceId:n&&n.id,spaceKey:u,tree:{rootId:t,items:e},isContextualCreateEnabled:m,isCreateBlankFabricPageEnabled:Object(w.c)(a),isAnonymousUser:!d,apolloClient:h,showSpaceCardSpotlight:I}))})}}wt.displayName="PageTreeControllerClass",Object(a.a)(wt,"defaultProps",{isDraggable:!0});const xt=Object(E.h)(Object(S.a)()(wt));n.d(t,"PageTree",(function(){return Tt}));class Tt extends r.PureComponent{render(){const{onItemClick:e,isInDrawer:t,onDragDropSuccess:n}=this.props;return i.a.createElement(o.a,{attribution:c.a.DISCO},i.a.createElement(s.c,{to:[l.a]},a=>i.a.createElement(p.a.Consumer,null,({push:s})=>i.a.createElement(d.a.Consumer,null,({spaceKey:o,contentId:c,contentIdState:l})=>(c||l===g.a)&&i.a.createElement(u.a,null,({isSuperAdmin:l})=>i.a.createElement(r.Fragment,null,i.a.createElement(f.a,{name:b.a.PAGE_TREE,id:o}),i.a.createElement(xt,{isSuperAdmin:l,apolloClient:Object(h.getApolloClient)(),push:s,onItemClick:e,onDragDropSuccess:n,currentPageId:c,spaceKey:o,flags:a,isInDrawer:t})))))))}}Tt.displayName="PageTree",Object(a.a)(Tt,"defaultProps",{isInDrawer:!1,onDragDropSuccess:()=>{}})},uUTq:function(e,t,n){var a=n("X+YX"),r=n("R3TX"),i=n("Ndl3"),s=r((function(e,t){return i(e)?a(e,t):[]}));e.exports=s},vitU:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n("7kiZ"),r=n("zjKd"),i=n("U3X2"),s=n("jPWM");function o(e){return Object(a.a)({query:i.a,variables:{contentId:e,versionOverride:null}})}function c(e){return window.performance.mark("CFP-63.ContentBodyQuery.start"),Object(a.a)({query:r.a,variables:{contentId:e,versionOverride:null,embeddedContentRender:null}}).then(()=>{window.performance.mark("CFP-63.ContentBodyQuery.end")})}function l(e){return window.performance.mark("CFP-63.ContentRendererQuery.start"),Object(a.a)({query:s.a,variables:{contentId:e}}).then(()=>{window.performance.mark("CFP-63.ContentRendererQuery.end")})}function d(e){window.performance.mark("CFP-63.preloadContent.start"),Promise.all([o(e),l(e),c(e)]).then(()=>{window.performance.mark("CFP-63.preloadContent.end"),window.performance.mark("CFP-63.preloadContentEnd")})}},zjKd:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("KD1n"),r=n("H5qd");function i(){const e=Object(a.a)(["\n  query ContentBodyQuery(\n    $contentId: ID\n    $versionOverride: Int\n    $embeddedContentRender: String\n  ) {\n    content(\n      id: $contentId\n      version: $versionOverride\n      embeddedContentRender: $embeddedContentRender\n    ) {\n      nodes {\n        id\n        body {\n          view {\n            value\n            webresource {\n              tags {\n                css\n              }\n              uris {\n                js\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return i=function(){return e},e}const s=n.n(r)()(i())}}]);
//# sourceMappingURL=page-tree~b59ad437.RMZK19kq-v39.js.map