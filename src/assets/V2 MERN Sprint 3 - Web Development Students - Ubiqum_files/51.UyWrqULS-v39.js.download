(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{"7kiZ":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var o=n("cH76");const r=/query\s+(\w+).*?\{/,i={data:null};function a({query:t,variables:e={},fetchPolicy:n="cache-first"}){if("string"!=typeof t)return window.GLOBAL_APOLLO_CLIENT?window.GLOBAL_APOLLO_CLIENT.query({query:t,variables:e,errorPolicy:"all",fetchPolicy:n,context:{single:!0}}):Promise.resolve(i);const a=t.match(r);if(!a)return Promise.resolve(i);const c=a[1];return Object(o.a)().load({name:c,variables:e},()=>fetch("/cgraphql?q=QueryPreloader_".concat(c),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:t,variables:e})}).then(t=>t.ok?t.json():i).catch(()=>i))}},AzBY:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var o=n("ERkP");const r=Object(o.createContext)({firstHighlightShown:!1});r.displayName="HighlightActionsContext"},GrcB:function(t,e,n){"use strict";var o=n("ERkP"),r=n.n(o),i=n("gQ5V"),a=n("KD1n"),c=n("H5qd");function s(){const t=Object(a.a)(['\n  query ContentViewedEventQuery($contentId: ID) {\n    content(id: $contentId, trigger: "viewed") {\n      nodes {\n        id\n      }\n    }\n  }\n']);return s=function(){return t},t}const l=n.n(c)()(s());let u;n.d(e,"a",(function(){return d}));const d=({contentId:t})=>(Object(o.useEffect)(()=>{u=t},[t]),r.a.createElement(i.b,{query:l,variables:{contentId:t},fetchPolicy:"network-only",skip:u===t},()=>null));d.displayName="ContentViewedEvent"},IBaz:function(t,e,n){"use strict";var o=n("zjfJ"),r=n("ERkP"),i=n.n(r),a=n("L21V"),c=n("/sMe"),s=n("nZDR"),l=n.n(s),u=n("gloY"),d=n.n(u),h=n("IJlJ"),f=n("kHy1"),m=n("MjIW"),g=n("3Z2R"),p=n("FdGg"),y=n("X2PC"),b=n("Iy7w"),v=n("7nmT"),w=n.n(v),E=n("/D+w");const x=Object(b.a)("div",{target:"egsaodj0"})({name:"y7xd18",styles:"@keyframes popup{0%{opacity:0;}100%{opacity:1;}}position:absolute;transition:top 100ms ease-out,left 100ms ease-out;animation:popup 100ms forwards linear;"}),C=Object(b.a)("div",{target:"egsaodj1"})({name:"1obrnsz",styles:"transform:translate(calc(-50% - 5px),calc(-100% - 20px));box-shadow:rgba(9,30,66,0.6) 0px 4px 8px 0px,rgba(9,30,66,0.31) 0px 0px 1px;border-radius:3px;position:absolute;top:0;left:0;"}),O=Object(b.a)("div",{target:"egsaodj2"})({name:"5g18kj",styles:"padding:3px;background-color:#fff;border-radius:3px;display:flex;"}),j=Object(b.a)("div",{target:"egsaodj3"})({name:"1uxknoh",styles:"margin:5px 2px;width:1px;background-color:#ebecf0;"}),k=({children:t,top:e,left:n})=>{const o=document.querySelector("#".concat(E.b));return o?w.a.createPortal(i.a.createElement(x,{style:{top:e,left:n}},i.a.createElement(C,null,i.a.createElement(O,null,t))),o):null};var I=n("KkZ4");function A(t){return t.replace(/\u00a0/g," ")}function P(t,e,n){const o=Math.min(n,t.length-1);let r=o,i=t.length;for(;r<i;){const n=r+i>>1;t[n]<=e?r=n+1:i=n}return Math.max(r-1,o)}function S(t){return t&&t.nodeValue?t.nodeValue.length:0}const M=[".user-mention","[data-mention-id]",".ap-container",'a[href^="/"]','.conf-macro[data-hasbody="false"]',".status-lozenge-span",".date-lozenger-container",'[data-inline-card="true"]',".inlineCardView-content-wrap",".jira-issue",".ak-renderer-extension-overflow-container button",'[data-node-type="expand"] > button','[data-node-type="nestedExpand"] > button',"strike",'span[style="text-decoration: line-through;"]',".ak-renderer-extension"].join(",");function T(t){return $("<div>").append(t.cloneContents()).html()}function R(t){if(t.commonAncestorContainer){const e=t.commonAncestorContainer;return 3===e.nodeType?e.parentNode:e}}function L(t){const e=window.scrollY,n=window.scrollX;let o=t.getClientRects();if(!o.length&&t.parentElement&&t.parentElement()){const r=$(t.parentElement()),i=r.offset();i&&(o=[{top:i.top-e,left:i.left-n,bottom:i.top+(r.height()||0),right:i.left+(r.width()||0)}])}const r=function(t,e){const n={first:e[0],last:e[e.length-1]};return"undefined"!==t.endOffset&&0===t.endOffset&&e.length>1&&(n.last=e[e.length-2]),n}(t,o);return{first:function(t){const o={};return o.width=t.right-t.left,o.height=t.bottom-t.top,o.left=t.left+n,o.right=t.right+n,o.top=t.top+e,o.bottom=t.bottom+e,o}(r.first),average:function(t,o){const r={};return r.top=t.top,r.left=(t.left||0)+n,r.bottom=o.bottom,void 0!==t.left&&void 0!==t.right&&void 0!==o.left&&void 0!==o.right&&(t.left>=o.right?r.right=t.right:r.right=o.right),r.right=(r.right||0)+n,r.top=(r.top||0)+e,r.bottom=(r.bottom||0)+e,r.width=r.right-r.left,r.height=r.bottom-r.top,r}(r.first,r.last)}}function B(t,e,n,o){const r=Array.from(t.querySelectorAll(M)),{text:i,nodesStartPos:a,nodes:c}=function(t,e){let n,o="";const r=[],i=[],a=t=>e.some(e=>e===t||e.contains(t))?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT;a.acceptNode=a;const c=document.createNodeIterator(t,NodeFilter.SHOW_TEXT,a,!1);for(;n=c.nextNode();){const t=A(n.nodeValue);t.trim()&&(r.push(o.length),i.push(n),o+=t)}return{text:o,nodesStartPos:r,nodes:i}}(t,r),{index:s,numMatches:l}=function(t,e,n,o,r,i){if(!n)return{numMatches:0,index:-1};let a=0,c=0,s=0,l=-1,u=0;for(;-1!==(s=t.indexOf(e,a));){const t=P(r,s,c),e=i[t];let d=n;if(3===d.nodeType&&o>=S(d)&&(o-=S(d),d=n.nextSibling),d&&(3===d.nodeType&&e===d||3!==d.nodeType&&d.contains(e))){s-r[t]<=o&&(l=u)}u++,a=s+1,c=t}return{numMatches:u,index:l}}(i,e,n.startContainer,n.startOffset,a,c);return{pageId:o,selectedText:e,index:s,numMatches:l}}function N(t,e,n){const o=function(t){return A(String(t))}(e),r=o.trim();let i;return r&&(i=B(t,o,e,n)),{text:r,searchText:i,area:L(e),html:T(e),containingElement:R(e),range:e}}const H=(t,e)=>()=>{const n=window.getSelection();n&&window.dispatchEvent(new CustomEvent("create-inline-comment",{detail:N(t,n.getRangeAt(0),e)}))},_=(t,e)=>()=>{const n=window.getSelection();n&&(Object(I.getAnalyticsWebClient)().then(t=>{t.sendUIEvent({action:"clicked",actionSubject:"button",actionSubjectId:"jiraIssueLink",source:"HighlightContextMenu"}).fire()}),window.dispatchEvent(new CustomEvent("create-jira-issue-summary",{detail:N(t,n.getRangeAt(0),e)})))};var z=n("AzBY"),q=n("KD1n"),K=n("daKX");function J(){const t=Object(q.a)(["An error occured on highlighting content"]);return J=function(){return t},t}const D=Object(K.a)("highlight-action");n.d(e,"a",(function(){return V}));class V extends r.Component{constructor(...t){super(...t),Object(o.a)(this,"state",{firstHighlightShown:!1,show:!1,top:0,left:0}),Object(o.a)(this,"mounted",!1),Object(o.a)(this,"content",i.a.createRef()),Object(o.a)(this,"onContainerResized",()=>{this.setState({show:!1})}),Object(o.a)(this,"onMouseUp",t=>requestAnimationFrame(()=>{if(!this.mounted)return;const e=function(){const t=window.getSelection();if(!t||t.isCollapsed)return null;const e=t.getRangeAt(0);return String(e).trim()?e:null}(),n=document.querySelector("#".concat(E.b)),o=document.querySelector(".ic-sidebar");if(!e||!n||!this.content.current||o&&o.contains(t.target)||!this.content.current.contains(t.target)&&this.content.current!==t.target&&!t.target.closest("button[disabled]"))return void this.setState({show:!1});const r=n.getBoundingClientRect(),i=this.content.current.getBoundingClientRect(),a=e.getClientRects();if(!a||!a.length)return void this.setState({show:!1});const c=Array.from(a).find(t=>0!==t.width&&0!==t.height);if(c){const{left:n,right:o,top:a,width:s}=c,l=t.clientX,u=n+(s>>1);let d=i.left,h=i.right;const f=function t(e){return e?3!==e.nodeType&&e.scrollWidth>e.clientWidth?e:t(e.parentNode):null}(e.startContainer);if(f){const t=f.getBoundingClientRect();d=Math.max(d,t.left),h=Math.min(h,t.right)}let m=Math.abs(l-u)>100&&n<=l&&l<=o?l:u;m=Math.max(d,Math.min(h,m)),this.setState({firstHighlightShown:!0,show:!0,left:m-r.left,top:a-r.top})}})),Object(o.a)(this,"createInlineCommentButton",t=>{if(!this.content.current)return null;const{contentId:e}=this.props,n=((t,e)=>{const n=window.getSelection();if(!n)return!1;let o;try{o=N(t,n.getRangeAt(0),e)}catch(t){D.error(J())}if(!o||!o.searchText)return!1;const{searchText:{selectedText:r,index:i,numMatches:a}}=o;return r.replace(/\n/g,"").length>0&&-1!==i&&a>0&&i<a})(this.content.current,e),o=i.a.createElement(c.a,{appearance:"subtle",iconBefore:i.a.createElement(d.a,{size:"medium",label:""}),"data-key":t,isDisabled:!n,testId:"createInlineCommentButton",onClick:H(this.content.current,e)},i.a.createElement(a.c,{id:"highlight-actions.inline-comments.comment",defaultMessage:"Comment",description:"Make a new comment"}));return n?i.a.createElement(r.Fragment,{key:"inline-comment-button"},o):i.a.createElement(h.a,{key:"inline-comment-button",delay:0,position:"top",content:i.a.createElement(a.c,{id:"highlight-actions.inline-comments.comment.unsupported",defaultMessage:"Comments can only be added to text that doesnâ€™t contain an emoji, a macro, or an @mention"})},o)})}componentDidMount(){this.mounted=!0,window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("highlight-actions.container.resized",this.onContainerResized),Object(f.a)({contentId:this.props.contentId,location:m.a.ACTION_PANEL})}componentWillUnmount(){this.mounted=!1,window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("highlight-actions.container.resized",this.onContainerResized)}createJiraIssueButton(t){if(!this.content.current)return null;const{contentId:e}=this.props;return i.a.createElement(c.a,{key:"jira-issue-button",appearance:"subtle",iconBefore:i.a.createElement(l.a,{size:"medium",label:""}),"data-key":t,testId:"createJiraIssueButton",onClick:_(this.content.current,e)},i.a.createElement(a.c,{id:"highlight-actions.create-issue",defaultMessage:"Create issue",description:"Create a new Jira issue"}))}createGenericButton({styleClass:t,completeKey:e,label:n}){return i.a.createElement(c.a,{key:e,appearance:"subtle","data-key":e,className:t},n)}render(){const{children:t,contentId:e}=this.props,{show:n,top:o,left:a}=this.state;return i.a.createElement(r.Fragment,null,i.a.createElement(z.a.Provider,{value:{firstHighlightShown:this.state.firstHighlightShown}},i.a.createElement("div",{key:"content-container",ref:this.content},t)),i.a.createElement(p.a,{attribution:y.a.BACKBONE},n?i.a.createElement(g.a,{key:"action-panel",contentId:e,location:m.a.ACTION_PANEL,fetchPolicy:"cache-first"},({webItems:t})=>{let e=t.map(t=>{const{completeKey:e}=t;return e.endsWith("create-inline-comment")?this.createInlineCommentButton(e):e.endsWith("create-JIRA-issue-summary")?this.createJiraIssueButton(e):this.createGenericButton(t)});const n=e.length;return e=e.reduce((t,e,o)=>(t.push(e),o!==n-1&&t.push(i.a.createElement(j,{key:"divider-".concat(o)})),t),[]),e.length?i.a.createElement(k,{top:o,left:a},e):null}):null))}}V.displayName="HighlightActions"},aiom:function(t,e,n){"use strict";var o=n("ERkP"),r=n.n(o),i=n("lZoD"),a=n("WWAs"),c=n("Ua4J");var s=n("03Pf");const l=({anchorContainer:t,scrollCorrectionPixels:e})=>{const{setHash:n}=Object(o.useContext)(c.a),r=Object(o.useCallback)(o=>{if(!t.current)return;if(o.defaultPrevented)return;const r=function(t,e=document){if(!t)return null;if(0!==t.button)return null;if("click"!==t.type)return null;if(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)return null;const n=t.target;if(!(n instanceof HTMLAnchorElement))return null;if(n.target&&"_self"!==n.target)return null;if(!n.hash)return null;const o=n.ownerDocument;if(!o||o!==document)return null;if(!(o.location.origin+o.location.pathname===n.origin+n.pathname))return null;const r=n.hash.substr(1),i=document.getElementById(r);return null==i?null:e.contains(i)?{anchorElement:i,hash:r}:null}(o,t.current);if(r){const{anchorElement:t,hash:i}=r;o.preventDefault(),Object(s.b)(t,e),n(i)}},[t,e,n]);Object(o.useEffect)(()=>(window.addEventListener("click",r),()=>{window.removeEventListener("click",r)}),[r])};n.d(e,"a",(function(){return u}));const u=({anchorContainer:t})=>{const[e,n]=Object(o.useState)(0);return l({anchorContainer:t,scrollCorrectionPixels:-e}),r.a.createElement(i.c,{to:[a.a]},t=>(n(t.getTotalHeight()),null))};u.displayName="ScrollToHashLinkHandler",u.displayName="ScrollToHashLinkHandler"},gloY:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n("ERkP")),r=i(n("4KTy"));function i(t){return t&&t.__esModule?t:{default:t}}function a(){return(a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}).apply(this,arguments)}var c=function(t){return o.default.createElement(r.default,a({dangerouslySetGlyph:'<svg width="24" height="24" viewBox="0 0 24 24" focusable="false" role="presentation"><g fill="currentColor" fill-rule="evenodd"><path d="M4.998 11.513c0-3.038 3.141-5.51 7.002-5.51 3.861 0 7.002 2.472 7.002 5.51 0 3.039-3.141 5.51-7.002 5.51-3.861 0-7.002-2.471-7.002-5.51zm14.84 7.771v-.002s-1.564-2.26-.767-3.116l-.037.02C20.261 14.902 21 13.279 21 11.513 21 7.371 16.963 4 12 4s-9 3.37-9 7.513 4.037 7.514 9 7.514c1.42 0 2.76-.285 3.957-.776 1.003 1.022 2.287 1.572 3.24 1.719l.002-.003a.524.524 0 0 0 .164.033.515.515 0 0 0 .474-.716z"/><rect x="7" y="9" width="10" height="2" rx="1"/><rect x="7" y="12" width="5" height="2" rx="1"/></g></svg>'},t))};c.displayName="CommentIcon";var s=c;e.default=s},kHy1:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var o=n("7kiZ"),r=n("0+uK");function i({location:t=null,contentId:e=null,spaceKey:n=null,version:i=null}={}){const a={location:Array.isArray(t)?null:t,locations:Array.isArray(t)?t:[],contentId:e,spaceKey:n,version:i};return Object(o.a)({query:r.a,variables:a})}},nZDR:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n("ERkP")),r=i(n("4KTy"));function i(t){return t&&t.__esModule?t:{default:t}}function a(){return(a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}).apply(this,arguments)}var c=function(t){return o.default.createElement(r.default,a({dangerouslySetGlyph:'<svg width="24" height="24" viewBox="0 0 24 24" focusable="false" role="presentation"><path d="M13 11V3.993A.997.997 0 0 0 12 3c-.556 0-1 .445-1 .993V11H3.993A.997.997 0 0 0 3 12c0 .557.445 1 .993 1H11v7.007c0 .548.448.993 1 .993.556 0 1-.445 1-.993V13h7.007A.997.997 0 0 0 21 12c0-.556-.445-1-.993-1H13z" fill="currentColor" fill-rule="evenodd"/></svg>'},t))};c.displayName="AddIcon";var s=c;e.default=s}}]);
//# sourceMappingURL=51.UyWrqULS-v39.js.map